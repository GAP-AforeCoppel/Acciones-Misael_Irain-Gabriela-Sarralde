<!DOCTYPE html>
<html lang="es"><head><script>(function(firebaseConfig, initialAuthToken, appId) {
        window.__firebase_config = firebaseConfig;
        window.__initial_auth_token = initialAuthToken;
        window.__app_id = appId;
            })("\n{\n  \"apiKey\": \"AIzaSyCqyCcs2R2e7AegGjvFAwG98wlamtbHvZY\",\n  \"authDomain\": \"bard-frontend.firebaseapp.com\",\n  \"projectId\": \"bard-frontend\",\n  \"storageBucket\": \"bard-frontend.firebasestorage.app\",\n  \"messagingSenderId\": \"175205271074\",\n  \"appId\": \"1:175205271074:web:2b7bd4d34d33bf38e6ec7b\"\n}\n","eyJhbGciOiJSUzI1NiIsImtpZCI6IjdiNWFlNDg4ZGU5NDlkNmY0OGJhYzU1ZmMwYTE1NzJlZTJmNjExMzciLCJ0eXAiOiJKV1QifQ.eyJzdWIiOiJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BiYXJkLWZyb250ZW5kLmlhbS5nc2VydmljZWFjY291bnQuY29tIiwiYXVkIjoiaHR0cHM6Ly9pZGVudGl0eXRvb2xraXQuZ29vZ2xlYXBpcy5jb20vZ29vZ2xlLmlkZW50aXR5LmlkZW50aXR5dG9vbGtpdC52MS5JZGVudGl0eVRvb2xraXQiLCJ1aWQiOiIxNDkzMDE5OTQ4OTUyNTM0MTE2OCIsImlzcyI6ImZpcmViYXNlLWFkbWluc2RrLWZic3ZjQGJhcmQtZnJvbnRlbmQuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLCJjbGFpbXMiOnsiYXBwSWQiOiJjX2M5MGI2NGY1MGVmNTVhODBfZGFzaGJvYXJkX3Jlc3VsdGFkb3MuaHRtbC00NjMifSwiZXhwIjoxNzcxNjM2OTM5LCJpYXQiOjE3NzE2MzMzMzksImFsZyI6IlJTMjU2In0.QyQ0YwpwZxzafTRnX87u0z2U168rCrT1X1qRJsH3DXAAQxpFn8rw3V9iUUr6LmIys_vLstRqcp-1SNup9MDGlzbC_9OUYPcpgZhwNa5HxhGVXAii_bVXHP0FIX8irK9YVn6pq1pMfuPaIloPie5kdGKDqgpV6Pj5ynTRWGuWgUCfFkqeBznZfcJTRFweX-yECSxI0rN6ReJlr3UT76VSEBg6yGH9HEhrxPCBLsKjRupxO2MKgKCXEdcoOxhAy_M_onIxKTxPLWxooE5sll8mZzU89aL6NgauzQmvRkA2u--B-OD-xemdpfxuVHJUwTwvyrm_Um3E7BNk_eJuY4OOtw","c_c90b64f50ef55a80_dashboard_resultados.html-463")</script><script>(function(){'use strict';var h=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a};function l(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");}var n=l(this);
function p(a,b){if(b)a:{var d=n;a=a.split(".");for(var c=0;c<a.length-1;c++){var e=a[c];if(!(e in d))break a;d=d[e]}a=a[a.length-1];c=d[a];b=b(c);b!=c&&b!=null&&h(d,a,{configurable:!0,writable:!0,value:b})}}function r(a){function b(c){return a.next(c)}function d(c){return a.throw(c)}return new Promise(function(c,e){function f(g){g.done?c(g.value):Promise.resolve(g.value).then(b,d).then(f,e)}f(a.next())})}function t(a){return r(a())}
p("Object.values",function(a){return a?a:function(b){var d=[],c;for(c in b)Object.prototype.hasOwnProperty.call(b,c)&&d.push(b[c]);return d}});p("Array.prototype.includes",function(a){return a?a:function(b,d){var c=this;c instanceof String&&(c=String(c));var e=c.length;d=d||0;for(d<0&&(d=Math.max(d+e,0));d<e;d++){var f=c[d];if(f===b||Object.is(f,b))return!0}return!1}});/*

 MIT License

 Copyright (c) 2017-2023 W.Y.

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions:

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 SOFTWARE.

*/
function u(a,b){const d=a.style;b.backgroundColor&&(d.backgroundColor=b.backgroundColor);b.width&&(d.width=`${b.width}px`);b.height&&(d.height=`${b.height}px`);const c=b.style;c!=null&&Object.keys(c).forEach(e=>{d[e]=c[e]})};var v=(()=>{let a=0;return()=>{a+=1;return`u${`0000${(Math.random()*1679616<<0).toString(36)}`.slice(-4)}${a}`}})();function w(a){const b=[];for(let d=0,c=a.length;d<c;d++)b.push(a[d]);return b}let x=null;function y(a={}){return x?x:a.l?x=a.l:x=w(window.getComputedStyle(document.documentElement))}function z(a,b){return(a=(a.ownerDocument.defaultView||window).getComputedStyle(a).getPropertyValue(b))?parseFloat(a.replace("px","")):0}
function A(a,b={}){var d;if(!(d=b.width)){d=z(a,"border-left-width");var c=z(a,"border-right-width");d=a.clientWidth+d+c}(b=b.height)||(b=z(a,"border-top-width"),c=z(a,"border-bottom-width"),b=a.clientHeight+b+c);return{width:d,height:b}}function B(a){return new Promise((b,d)=>{const c=new Image;c.onload=()=>{c.decode().then(()=>{requestAnimationFrame(()=>b(c))})};c.onerror=d;c.crossOrigin="anonymous";c.decoding="async";c.src=a})}
function C(a){return t(function*(){return Promise.resolve().then(()=>(new XMLSerializer).serializeToString(a)).then(encodeURIComponent).then(b=>`data:image/svg+xml;charset=utf-8,${b}`)})}
function D(a,b,d){return t(function*(){const c=document.createElementNS("http://www.w3.org/2000/svg","svg"),e=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");c.setAttribute("width",`${b}`);c.setAttribute("height",`${d}`);c.setAttribute("viewBox",`0 0 ${b} ${d}`);e.setAttribute("width","100%");e.setAttribute("height","100%");e.setAttribute("x","0");e.setAttribute("y","0");e.setAttribute("externalResourcesRequired","true");c.appendChild(e);e.appendChild(a);return C(c)})}
var E=(a,b)=>{if(a instanceof b)return!0;a=Object.getPrototypeOf(a);return a===null?!1:a.constructor.name===b.name||E(a,b)};function F(a,b){return y(b).map(d=>{const c=a.getPropertyValue(d),e=a.getPropertyPriority(d);return`${d}: ${c}${e?" !important":""};`}).join(" ")}
function G(a,b,d,c){a=window.getComputedStyle(a,d);var e=a.getPropertyValue("content");if(e!==""&&e!=="none"){var f=v();try{b.className=`${b.className} ${f}`}catch(k){return}e=document.createElement("style");var g=e.appendChild;d=`.${f}:${d}`;a.cssText?(c=a.getPropertyValue("content"),c=`${a.cssText} content: '${c.replace(/'|"/g,"")}';`):c=F(a,c);g.call(e,document.createTextNode(`${d}{${c}}`));b.appendChild(e)}};function H(a){return a.search(/^(data:)/)!==-1}function I(a,b,d){return t(function*(){const c=yield fetch(a,b);if(c.status===404)throw Error(`Resource "${c.url}" not found`);const e=yield c.blob();return new Promise((f,g)=>{const k=new FileReader;k.onerror=g;k.onloadend=()=>{try{f(d({o:c,result:k.result}))}catch(m){g(m)}};k.readAsDataURL(e)})})}const J={};function K(a,b,d){let c=a.replace(/\?.*/,"");d&&(c=a);/ttf|otf|eot|woff2?/i.test(c)&&(c=c.replace(/.*\//,""));return b?`[${b}]${c}`:c}
function L(a,b,d){return t(function*(){const c=K(a,b,d.C);if(J[c]!=null)return J[c];d.u&&(a+=(/\?/.test(a)?"&":"?")+(new Date).getTime());let e;try{const f=yield I(a,d.i,({o:g,result:k})=>{b||(b=g.headers.get("Content-Type")||"");return k.split(/,/)[1]});e=`data:${b};base64,${f}`}catch(f){e=d.B||""}return J[c]=e})};const M={P:"application/font-woff",R:"application/font-woff",N:"application/font-truetype",v:"application/vnd.ms-fontobject",H:"image/png",F:"image/jpeg",D:"image/jpeg",A:"image/gif",M:"image/tiff",L:"image/svg+xml",O:"image/webp"};function N(a){return(a=/\.([^./]*?)$/g.exec(a))?a[1]:""};function O(a){return t(function*(){const b=a.toDataURL();return b==="data:,"?a.cloneNode(!1):B(b)})}function aa(a,b){return t(function*(){if(a.currentSrc){var d=document.createElement("canvas");const c=d.getContext("2d");d.width=a.clientWidth;d.height=a.clientHeight;c==null||c.drawImage(a,0,0,d.width,d.height);d=d.toDataURL();return B(d)}d=a.poster;d=yield L(d,M[N(d).toLowerCase()]||"",b);return B(d)})}
function ba(a,b){return t(function*(){try{let d;if(a==null?0:(d=a.contentDocument)==null?0:d.body)return yield P(a.contentDocument.body,b,!0)}catch(d){}return a.cloneNode(!1)})}function ca(a,b){return t(function*(){return E(a,HTMLCanvasElement)?O(a):E(a,HTMLVideoElement)?aa(a,b):E(a,HTMLIFrameElement)?ba(a,b):a.cloneNode(a.tagName!=null&&a.tagName.toUpperCase()==="SVG")})}
function da(a,b,d){return t(function*(){if(b.tagName!=null&&b.tagName.toUpperCase()==="SVG")return b;let c=[];if(a.tagName!=null&&a.tagName.toUpperCase()==="SLOT"&&a.assignedNodes)c=w(a.assignedNodes());else{let e;if(E(a,HTMLIFrameElement)&&((e=a.contentDocument)==null?0:e.body))c=w(a.contentDocument.body.childNodes);else{let f;c=w(((f=a.shadowRoot)!=null?f:a).childNodes)}}if(c.length===0||E(a,HTMLVideoElement))return b;yield c.reduce((e,f)=>e.then(()=>P(f,d)).then(g=>{g&&b.appendChild(g)}),Promise.resolve());
return b})}function ea(a,b,d){const c=b.style;if(c){var e=window.getComputedStyle(a);e.cssText?(c.cssText=e.cssText,c.transformOrigin=e.transformOrigin):y(d).forEach(f=>{let g=e.getPropertyValue(f);f==="font-size"&&g.endsWith("px")&&(g=`${Math.floor(parseFloat(g.substring(0,g.length-2)))-.1}px`);E(a,HTMLIFrameElement)&&f==="display"&&g==="inline"&&(g="block");f==="d"&&b.getAttribute("d")&&(g=`path(${b.getAttribute("d")})`);c.setProperty(f,g,e.getPropertyPriority(f))})}}
function fa(a,b){E(a,HTMLSelectElement)&&(b=Array.from(b.children).find(d=>a.value===d.getAttribute("value")))&&b.setAttribute("selected","")}
function ha(a,b){return t(function*(){var d=a.querySelectorAll?a.querySelectorAll("use"):[];if(d.length===0)return a;var c={};for(var e=0;e<d.length;e++){var f=d[e].getAttribute("xlink:href");if(f){const g=document.querySelector(f);a.querySelector(f)||!g||c[f]||(c[f]=yield P(g,b,!0))}}d=Object.values(c);if(d.length){c=document.createElementNS("http://www.w3.org/1999/xhtml","svg");c.setAttribute("xmlns","http://www.w3.org/1999/xhtml");c.style.position="absolute";c.style.width="0";c.style.height="0";
c.style.overflow="hidden";c.style.display="none";e=document.createElementNS("http://www.w3.org/1999/xhtml","defs");c.appendChild(e);for(f=0;f<d.length;f++)e.appendChild(d[f]);a.appendChild(c)}return a})}
function P(a,b,d){return t(function*(){return d||!b.filter||b.filter(a)?Promise.resolve(a).then(c=>ca(c,b)).then(c=>da(a,c,b)).then(c=>{E(c,Element)&&(ea(a,c,b),G(a,c,":before",b),G(a,c,":after",b),E(a,HTMLTextAreaElement)&&(c.textContent=a.value),E(a,HTMLInputElement)&&c.setAttribute("value",a.value),fa(a,c));return c}).then(c=>ha(c,b)):null})};const Q=/url\((['"]?)([^'"]+?)\1\)/g,ia=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,ja=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ka(a){const b=[];a.replace(Q,(d,c,e)=>{b.push(e);return d});return b.filter(d=>!H(d))}
function la(a,b,d,c){return t(function*(){try{const e=d?(new URL(b,d||void 0)).toString():b;let f;f=yield L(e,M[N(b).toLowerCase()]||"",c);return a.replace(new RegExp(`(url\\(['"]?)(${b.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1")})(['"]?\\))`,"g"),`$1${f}$3`)}catch(e){}return a})}function ma(a,{I:b}){return b?a.replace(ja,d=>{for(;;){const [c,,e]=ia.exec(d)||[],f=c,g=e;if(!g)return"";if(g===b)return`src: ${f};`}}):a}
function R(a,b,d){return t(function*(){if(a.search(Q)===-1)return a;const c=ma(a,d);return ka(c).reduce((e,f)=>e.then(g=>la(g,f,b,d)),Promise.resolve(c))})};function S(a,b,d){return t(function*(){var c;const e=(c=b.style)==null?void 0:c.getPropertyValue(a);return e?(c=yield R(e,null,d),b.style.setProperty(a,c,b.style.getPropertyPriority(a)),!0):!1})}function na(a,b){return t(function*(){(yield S("background",a,b))||(yield S("background-image",a,b));(yield S("mask",a,b))||(yield S("-webkit-mask",a,b))||(yield S("mask-image",a,b))||(yield S("-webkit-mask-image",a,b))})}
function oa(a,b){return t(function*(){const d=E(a,HTMLImageElement);if(d&&!H(a.src)||E(a,SVGImageElement)&&!H(a.href.baseVal)){var c=d?a.src:a.href.baseVal,e=yield L(c,M[N(c).toLowerCase()]||"",b);yield new Promise((f,g)=>{a.onload=f;a.onerror=b.m?(...k)=>{try{f(b.m(...k))}catch(m){g(m)}}:g;a.decode&&(a.decode=f);a.loading==="lazy"&&(a.loading="eager");d?(a.srcset="",a.src=e):a.href.baseVal=e})}})}
function pa(a,b){return t(function*(){const d=w(a.childNodes).map(c=>T(c,b));yield Promise.all(d).then(()=>a)})}function T(a,b){return t(function*(){E(a,Element)&&(yield na(a,b),yield oa(a,b),yield pa(a,b))})};const U={};function V(a){return t(function*(){var b=U[a];if(b!=null)return b;b=yield(yield fetch(a)).text();b={url:a,cssText:b};return U[a]=b})}function W(a,b){return t(function*(){let d=a.cssText;const c=/url\(["']?([^"')]+)["']?\)/g,e=(d.match(/url\([^)]+\)/g)||[]).map(f=>t(function*(){let g=f.replace(c,"$1");g.startsWith("https://")||(g=(new URL(g,a.url)).href);return I(g,b.i,({result:k})=>{d=d.replace(f,`url(${k})`);return[f,k]})}));return Promise.all(e).then(()=>d)})}
function X(a){if(a==null)return[];const b=[];a=a.replace(/(\/\*[\s\S]*?\*\/)/gi,"");for(var d=RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");;){var c=d.exec(a);if(c===null)break;b.push(c[0])}a=a.replace(d,"");d=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi;for(c=RegExp("((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})","gi");;){let e=d.exec(a);if(e===null)if(e=c.exec(a),e===null)break;else d.lastIndex=c.lastIndex;else c.lastIndex=
d.lastIndex;b.push(e[0])}return b}
function qa(a,b){return t(function*(){const d=[],c=[];a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach((f,g)=>{if(f.type===CSSRule.IMPORT_RULE){let k=g+1;f=V(f.href).then(m=>W(m,b)).then(m=>X(m).forEach(q=>{try{e.insertRule(q,q.startsWith("@import")?k+=1:e.cssRules.length)}catch(Da){}})).catch(()=>{});c.push(f)}})}catch(f){const g=a.find(k=>k.href==null)||document.styleSheets[0];e.href!=null&&c.push(V(e.href).then(k=>W(k,b)).then(k=>X(k).forEach(m=>{g.insertRule(m,g.cssRules.length)})).catch(()=>
{}))}});return Promise.all(c).then(()=>{a.forEach(e=>{if("cssRules"in e)try{w(e.cssRules||[]).forEach(f=>{d.push(f)})}catch(f){}});return d})})}function ra(a){return a.filter(b=>b.type===CSSRule.FONT_FACE_RULE).filter(b=>b.style.getPropertyValue("src").search(Q)!==-1)}function sa(a,b){return t(function*(){if(a.ownerDocument==null)throw Error("Provided element is not within a Document");var d=w(a.ownerDocument.styleSheets);d=yield qa(d,b);return ra(d)})}
function ta(a){function b(c){(c.style.fontFamily||getComputedStyle(c).fontFamily).split(",").forEach(e=>{d.add(e.trim().replace(/["']/g,""))});Array.from(c.children).forEach(e=>{e instanceof HTMLElement&&b(e)})}const d=new Set;b(a);return d}function ua(a,b){return t(function*(){const d=yield sa(a,b),c=ta(a);return(yield Promise.all(d.filter(e=>c.has(e.style.fontFamily.trim().replace(/["']/g,""))).map(e=>R(e.cssText,e.parentStyleSheet?e.parentStyleSheet.href:null,b)))).join("\n")})}
function va(a,b){return t(function*(){const d=b.j!=null?b.j:b.K?null:yield ua(a,b);if(d){const c=document.createElement("style");c.appendChild(document.createTextNode(d));a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}})};function wa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b),e=yield P(a,b,!0);yield va(e,b);yield T(e,b);u(e,b);return yield D(e,d,c)})}
function xa(a,b={}){return t(function*(){const {width:d,height:c}=A(a,b);var e=yield wa(a,b);e=yield B(e);const f=document.createElement("canvas"),g=f.getContext("2d"),k=b.G||window.devicePixelRatio||1,m=b.h||d,q=b.g||c;f.width=m*k;f.height=q*k;!b.J&&(f.width>16384||f.height>16384)&&(f.width>16384&&f.height>16384?f.width>f.height?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=16384):f.width>16384?(f.height*=16384/f.width,f.width=16384):(f.width*=16384/f.height,f.height=
16384));f.style.width=`${m}`;f.style.height=`${q}`;b.backgroundColor&&(g.fillStyle=b.backgroundColor,g.fillRect(0,0,f.width,f.height));g.drawImage(e,0,0,f.width,f.height);return f})}function ya(a,b={}){return t(function*(){return(yield xa(a,b)).toDataURL()})};const za=["gemini.google.com","corp.google.com","proxy.googlers.com"];function Y(){return document.body.querySelectorAll('[class*="animate"]').length>0}function Z(a){return t(function*(){try{return yield ya(a,{h:a.offsetWidth,g:a.offsetHeight})}catch(d){var b=a.offsetHeight;const c=document.createElement("canvas");c.width=a.offsetWidth;c.height=b;return c.toDataURL("image/png")}})}
function Aa(){return t(function*(){const a=document.body.offsetWidth,b=document.body.offsetHeight,d=document.body.cloneNode(!0);d.querySelectorAll('[class*="animate"]').forEach(c=>{c.classList.remove(...Array.from(c.classList).filter(e=>e.startsWith("animate")))});d.style.width=`${a}px`;d.style.height=`${b}px`;return d})}
function Ba(a){return t(function*(){let b=document.body;if(Y()){var d=yield Aa();b=d;document.body.appendChild(d)}d=yield Z(b);Y()&&document.body.removeChild(b);window.parent.postMessage({type:"SEND_SCREENSHOT",image:d,topOffset:document.documentElement.scrollTop},a.origin)})}function Ca(a){return t(function*(){const b={type:"SEND_SCREENSHOT_FOR_DATA_VISUALIZATION",image:yield Z(document.body),topOffset:0};window.parent.postMessage(b,a.origin)})}
window.addEventListener("message",a=>t(function*(){if(za.some(d=>a.origin.includes(d))){var b=a.data;b&&(b.type==="MAKE_SCREENSHOT"&&(yield Ba(a)),b.type==="MAKE_SCREENSHOT_FOR_DATA_VISUALIZATION"&&(yield Ca(a)))}}));
})();</script><script>(function() {
  // Ensure this script is executed only once
  if (window.firebaseAuthBridgeScriptLoaded) {
    return;
  }
  window.firebaseAuthBridgeScriptLoaded = true;

  let nextTokenPromiseId = 0;

  // Stores { resolve, reject } for ongoing token requests
  const pendingTokenPromises = {};

  // Listen for messages from the Host Application
  window.addEventListener('message', function(event) {

    const messageData = event.data;

  if (messageData && messageData.type === 'RESOLVE_NEW_FIREBASE_TOKEN') {
      const { success, token, error, promiseId } = messageData ?? {};
      if (pendingTokenPromises[promiseId]) {
        if (success) {
          pendingTokenPromises[promiseId].resolve(token);
        } else {
          pendingTokenPromises[promiseId].reject(new Error(error || 'Token refresh failed from host.'));
        }
        delete pendingTokenPromises[promiseId];
      }
    }
  });

  // Expose a function for the Generated App to request a new Firebase token
  window.requestNewFirebaseToken = function() {
    const currentPromiseId = nextTokenPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingTokenPromises[currentPromiseId] = { resolve, reject };
    });
    if (window.parent && window.parent !== window) {
      window.parent.postMessage({
        type: 'REQUEST_NEW_FIREBASE_TOKEN',
        promiseId: currentPromiseId
      }, '*');
    } else {
      pendingTokenPromises[currentPromiseId].reject(new Error('No parent window to request token from.'));
      delete pendingTokenPromises[currentPromiseId];
    }
    return promise;
  };
})();</script><script>
let realOriginalGetUserMedia = null;
if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
  realOriginalGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);
}

(function() {
  if (navigator.mediaDevices && navigator.mediaDevices.__proto__) {
    try {
      Object.defineProperty(navigator.mediaDevices.__proto__, 'getUserMedia', {
        get: function() {
          return undefined; // Or throw an error
        },
        configurable: false
      });
    } catch (error) {
      console.error("Error defining prototype getter:", error);
    }
  }
})();

(function() {
  const pendingMediaResolvers = {};
  let nextMediaPromiseId = 0;

  function requestMediaPermissions(constraints) {
    const mediaPromiseId = nextMediaPromiseId++;
    const promise = new Promise((resolve, reject) => {
      pendingMediaResolvers[mediaPromiseId] = (granted) => {
        delete pendingMediaResolvers[mediaPromiseId];
        resolve(granted);
      };
    });

    window.parent.postMessage({
      type: 'requestMediaPermission',
      constraints: constraints,
      promiseId: mediaPromiseId,
    }, '*');

    return promise;
  }

  let originalGetUserMedia = realOriginalGetUserMedia;

  function interceptGetUserMedia() {
    if (navigator.mediaDevices) {
      Object.defineProperty(navigator.mediaDevices, 'getUserMedia', {
        value: function(constraints) {
          return requestMediaPermissions(constraints).then((granted) => {
            if (granted) {
              if (originalGetUserMedia) {
                return originalGetUserMedia(constraints);
              } else {
                throw new Error("Original getUserMedia not available.");
              }
            } else {
              throw new DOMException('Permission denied', 'NotAllowedError');
            }
          });
        },
        writable: false,
        configurable: false
      });
    }
  }

  interceptGetUserMedia();

  const observer = new MutationObserver(function(mutationsList, observer) {
    for (const mutation of mutationsList) {
      if (mutation.type === 'reconfigured' && mutation.name === 'getUserMedia' && mutation.object === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'attributes' && mutation.attributeName === 'getUserMedia' && mutation.target === navigator.mediaDevices) {
        interceptGetUserMedia();
      } else if (mutation.type === 'childList' && mutation.addedNodes) {
        mutation.addedNodes.forEach(node => {
          if (node === navigator.mediaDevices) {
            interceptGetUserMedia();
          }
        });
      }
    }
  });

  function interceptSpeechRecognition() {
    if (!window.SpeechRecognition && !window.webkitSpeechRecognition) {
      return;
    }

    const OriginalSpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const SpeechRecognitionWrapper = function(...args) {
      const recognizer = new OriginalSpeechRecognition(...args);
      const originalStart = recognizer.start.bind(recognizer);

      recognizer.start = function() {
        requestMediaPermissions({ audio: true }).then(granted => {
          if (granted) {
            originalStart();
          } else {
            const errorEvent = new SpeechRecognitionErrorEvent('error');
            errorEvent.error = 'not-allowed'; // This is the standard error for permission denial.
            recognizer.dispatchEvent(errorEvent);
          }
        });
      };

      return recognizer;
    };

    SpeechRecognitionWrapper.prototype = OriginalSpeechRecognition.prototype;
    SpeechRecognitionWrapper.prototype.constructor = SpeechRecognitionWrapper;

    if (window.SpeechRecognition) {
      window.SpeechRecognition = SpeechRecognitionWrapper;
    }
    if (window.webkitSpeechRecognition) {
      window.webkitSpeechRecognition = SpeechRecognitionWrapper;
    }
  }

  interceptSpeechRecognition();

  window.addEventListener('message', function(event) {
    if (event.data) {
      if (event.data.type === 'resolveMediaPermission') {
        const { promiseId, granted } = event.data;
        if (pendingMediaResolvers[promiseId]) {
          pendingMediaResolvers[promiseId](granted);
        }
      }
    }
  });

})();</script><script>((function(modelInformation) {
  const originalFetch = window.fetch;
  // TODO: b/421908508 - Move these out of the script and match all generative AI model calls.
  let googleLlmBaseApiUrls = [
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':streamGenerateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.textModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageEditModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.imageTransformModelName + ':generateContent',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predict',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.videoModelName + ':predictLongRunning',
    'https://generativelanguage.googleapis.com/v1beta/models/' + modelInformation.ttsModelName + ':generateContent',
  ];
  modelInformation.deprecatedTextModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':streamGenerateContent',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':generateContent',
    );
  });
  modelInformation.deprecatedImageModelNames.forEach((modelName) => {
    googleLlmBaseApiUrls.push(
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predict',
      'https://generativelanguage.googleapis.com/v1beta/models/' + modelName + ':predictLongRunning',
    );
  });

  const pendingFetchResolvers = {};
  let nextPromiseId = 0;

  function handleStringInput(input, optionsArgument) {
    const actualUrl = input;
    const fetchCallArgs = [actualUrl, optionsArgument];
    const effectiveOptions = optionsArgument || {};
    const bodyForApiKeyCheck = effectiveOptions.body;
    const bodyForPostMessage = effectiveOptions.body;
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  function handleRequestInput(input, optionsArgument) {
    const actualUrl = input.url;
    const fetchCallArgs = [input, optionsArgument];
    const effectiveOptions = { method: input.method, headers: new Headers(input.headers) };
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (optionsArgument) {
      if (optionsArgument.method) effectiveOptions.method = optionsArgument.method;
      if (optionsArgument.headers) effectiveOptions.headers = new Headers(optionsArgument.headers);
      if ('body' in optionsArgument) {
        bodyForApiKeyCheck = optionsArgument.body;
        bodyForPostMessage = optionsArgument.body;
      } else {
        bodyForApiKeyCheck = undefined;
        bodyForPostMessage = input.body;
      }
    } else {
      bodyForApiKeyCheck = undefined;
      bodyForPostMessage = input.body;
    }
    return { actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage };
  }

  window.fetch = function(input, optionsArgument) {
    let actualUrl;
    let fetchCallArgs;
    let effectiveOptions = {};
    let bodyForApiKeyCheck;
    let bodyForPostMessage;

    if (typeof input === 'string') {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleStringInput(input, optionsArgument));
    } else if (input instanceof Request) {
      ({actualUrl, fetchCallArgs, effectiveOptions, bodyForApiKeyCheck, bodyForPostMessage} = handleRequestInput(input, optionsArgument));
    } else {
      return originalFetch.apply(window, [input, optionsArgument]);
    }

    effectiveOptions.method = effectiveOptions.method || 'GET';
    if (!effectiveOptions.headers) {
      effectiveOptions.headers = new Headers();
    }


    if (typeof actualUrl === 'string' && googleLlmBaseApiUrls.some((url) => actualUrl.startsWith(url))) {
      let apiKeyIsNull = true;

      const regex = new RegExp("models/([^:]+)");
      const modelNameMatch = actualUrl.match(regex);
      const modelName = modelNameMatch ? modelNameMatch[1] : 'unspecified';


      try {
        const urlObject = new URL(actualUrl);  // Use URL object for robust parsing
        const apiKeyParam = urlObject.searchParams.get('key');
        if (apiKeyParam) {
          apiKeyIsNull = false;
        }
      } catch (e) {
        // Continue checks even if URL parsing fails
      }

      if (apiKeyIsNull && effectiveOptions.headers) {
        const h = new Headers(effectiveOptions.headers);
        const apiKeyHeaderValue = h.get('X-API-Key') || h.get('x-api-key');
        if (apiKeyHeaderValue) {
          apiKeyIsNull = false;
          return originalFetch.apply(window, fetchCallArgs);
        }
      }

      if (apiKeyIsNull && effectiveOptions.method && ['POST', 'PUT', 'PATCH'].includes(effectiveOptions.method.toUpperCase()) && typeof bodyForApiKeyCheck === 'string') {
        try {
          const bodyData = JSON.parse(bodyForApiKeyCheck);
          if (bodyData && bodyData.apiKey) {
            apiKeyIsNull = false;
            return originalFetch.apply(window, fetchCallArgs);
          }
        } catch (e) {
          // Ignore JSON parsing errors
        }
      }

      if(apiKeyIsNull) {
        const promiseId = nextPromiseId++;
        const promise = new Promise((resolve) => {
          pendingFetchResolvers[promiseId] = (resolvedResponse) => {
            delete pendingFetchResolvers[promiseId];
            resolve(resolvedResponse);
          };
        });

        let serializedBodyForPostMessage;
        if (typeof bodyForPostMessage === 'string' || bodyForPostMessage == null) {
            serializedBodyForPostMessage = bodyForPostMessage;
        } else if (bodyForPostMessage instanceof ReadableStream) {
            serializedBodyForPostMessage = null;
        } else {
            try {
                serializedBodyForPostMessage = JSON.stringify(bodyForPostMessage);
            } catch (e) {
                serializedBodyForPostMessage = null;
            }
        }

        const messageOptions = {
            method: effectiveOptions.method,
            headers: Object.fromEntries(new Headers(effectiveOptions.headers).entries()),
            body: serializedBodyForPostMessage
        };

        window.parent.postMessage({
          type: 'requestFetch',
          url: actualUrl,
          modelName: modelName,
          options: messageOptions,
          promiseId: promiseId,
        }, '*');

        return promise;
      }
      return originalFetch.apply(window, fetchCallArgs);
    }
    return originalFetch.apply(window, fetchCallArgs);
  };

  window.addEventListener('message', function(event) {
    if (event.data && event.data.type === 'resolveFetch') {
      const { promiseId, response } = event.data;
      if (pendingFetchResolvers[promiseId]) {
        try {
          const reconstructedResponse = new Response(response.body, {
            status: response.status,
            statusText: response.statusText,
            headers: new Headers(response.headers),
          });
          pendingFetchResolvers[promiseId](reconstructedResponse);
        } catch (error) {
          pendingFetchResolvers[promiseId](new Response(null, { status: 500, statusText: "Interceptor Response Reconstruction Error" }));
        }
      }
    }
  });

}))({"textModelName":"gemini-2.5-flash","imageModelName":"imagen-4.0-generate-001","imageEditModelName":"gemini-2.5-flash-image-preview","imageTransformModelName":"gemini-3-pro-image-preview-11-2025","videoModelName":"veo-2.0-generate-001","ttsModelName":"gemini-2.5-flash-preview-tts","deprecatedTextModelNames":["gemini-2.0-flash","gemini-2.5-flash-preview-04-17","gemini-2.5-flash-preview-05-20","gemini-2.5-flash-preview-09-2025"],"deprecatedImageModelNames":["imagen-3.0-generate-001","imagen-3.0-generate-002"]})</script><script>(function(){'use strict';function a(){window.parent.postMessage({type:"interaction"},"*")}window.addEventListener("click",a,{capture:!0,passive:!0});window.addEventListener("touchstart",a,{capture:!0,passive:!0});window.addEventListener("keydown",a,{capture:!0,passive:!0});}).call(this);
</script><script>(function() {
  const originalConsoleLog = console.log;
  const originalConsoleError = console.error;

    /**
   * Normalizes an error event or a promise rejection reason into a structured error object.
   * @param {*} errorEventOrReason The error object or reason.
   * @return {object} Structured error data { message, name, stack }.
   */
  function getErrorObject(errorEventOrReason) {
    if (errorEventOrReason instanceof Error) {
      return {
        message: errorEventOrReason.message,
        name: errorEventOrReason.name,
        stack: errorEventOrReason.stack,
      };
    }
    // Fallback for non-Error objects.
    try {
      return {
        message: JSON.stringify(errorEventOrReason),
        name: 'UnknownErrorType',
        stack: null,
      };
    } catch (e) {
      return {
        message: String(errorEventOrReason),
        name: 'UnknownErrorTypeNonStringifiable',
        stack: null,
      };
    }
  }

  /**
   * Converts an array of arguments (from log/error) into a single string.
   * Handles Error objects specially to include their message and stack.
   * @param {Array<*>} args - Arguments passed to console methods.
   * @return {string} A string representation of the arguments.
   */
  function stringifyArgs(args) {
    return args
      .map((arg) => {
        if (arg instanceof Error) {
          const {message, stack} = arg;
          return `Error: ${message}${stack ? ('\nStack: ' + stack) : ''}`;
        }
        if (typeof arg === 'object' && arg !== null) {
          try {
            return JSON.stringify(arg);
          } catch (error) {
            return '[Circular Object]';
          }
        } else {
          return String(arg);
        }
      })
      .join(' ');
  }

  console.log = function(...args) {
    const logString = stringifyArgs(args);
    window.parent.postMessage({ type: 'log', message: logString }, '*');
    originalConsoleLog.apply(console, args);
  };

  console.error = function(...args) {
    let errorData;
    if (args.length > 0 && args[0] instanceof Error) {
      const err = args[0];
      // If the first arg is an Error, capture its details.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        ...getErrorObject(err),
        rawArgsString: stringifyArgs(args.slice(1)),
        timestamp: new Date().toISOString(),
      };
    } else {
      // If not an Error object, treat all args as a general error message.
      errorData = {
        type: 'error',
        source: 'CONSOLE_ERROR',
        message: stringifyArgs(args),
        name: 'ConsoleLoggedError',
        stack: null,
        timestamp: new Date().toISOString(),
      };
    }
    window.parent.postMessage(errorData, '*');
    originalConsoleError.apply(console, args);
  };

  // Listen for global unhandled synchronous errors.
  window.addEventListener('error', function(event) {
    const errorDetails = event.error ? getErrorObject(event.error) : {
      message: event.message,
      name: 'GlobalError',
      stack: null,
      filename: event.filename,
      lineno: event.lineno,
      colno: event.colno,
    };

    window.parent.postMessage({
      type: 'error',
      source: 'global',
      ...errorDetails,
      message: errorDetails.message || event.message,
      timestamp: new Date().toISOString(),
    }, '*');
  });

  // Listen for unhandled promise rejections (asynchronous errors).
  window.addEventListener('unhandledrejection', function(event) {
    const errorDetails = getErrorObject(event.reason);

    window.parent.postMessage({
      type: 'error',
      source: 'unhandledrejection',
      ...errorDetails,
      message: errorDetails.message || 'Unhandled Promise Rejection',
      timestamp: new Date().toISOString(),
    }, '*');
  });

})();</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentación Ejecutiva de Resultados</title>
    <!-- Cargando Tailwind CSS, Chart.js y Plugin Datalabels -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" crossorigin="anonymous"></script>
    <!-- Plugin necesario para mostrar etiquetas fijas en la gráfica -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js" crossorigin="anonymous"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            /* Variables originales del Dashboard */
            --primary-color: #1e3a8a; 
            --secondary-color: #64748b; 
            --accent-color: #fbbf24; 
            --bg-light: #f8fafc;

            /* Variables nuevas para el Organigrama */
            --color-blue: #002060;
            --color-yellow: #FFD966;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-light);
            color: #1e293b;
            position: relative; /* Necesario para el organigrama */
        }

        .gradient-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, #3b82f6 100%);
        }

        .editable-focus:focus {
            outline: 2px solid var(--accent-color);
            padding: 4px;
            border-radius: 4px;
            background-color: white;
            color: #1e293b !important;
        }

        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
            transition: transform 0.2s;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -9px;
            top: 0;
            width: 18px;
            height: 18px;
            background-color: var(--primary-color);
            border-radius: 50%;
            border: 4px solid white;
            z-index: 10;
        }

        /* --- ESTILOS DEL ORGANIGRAMA --- */
        .card-wrapper {
            transition: all 0.3s ease;
            position: relative;
            z-index: 10;
        }
        .card-content {
             min-width: 190px;
        }
        .card-content img { cursor: zoom-in; }
        .card-content img[src*="placehold.co"] { cursor: default; }

        /* Estilos de Interacción */
        .card-wrapper.dimmed {
            opacity: 0.3;
            transform: scale(0.95);
        }
        .card-wrapper.highlight-search {
            opacity: 1;
            transform: scale(1.05);
        }
        .card-wrapper.highlight-search .card-content {
            box-shadow: 0 0 0 4px var(--color-yellow);
        }

        /* VISTA VERTICAL */
        .vertical-view .tree ul {
            position: relative;
            padding-top: 50px;
            display: flex;
            justify-content: center;
        }
        .vertical-view .tree li {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            position: relative;
            padding: 0 10px;
        }
        /* Conector vertical */
        .vertical-view .tree li::before {
            content: '';
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 25px;
            background-color: var(--color-blue);
        }
        /* Conector horizontal */
        .vertical-view .tree li::after {
            content: '';
            position: absolute;
            top: -25px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--color-blue);
        }
        .vertical-view .tree > ul > li::before, .vertical-view .tree > ul > li::after { display: none; }
        .vertical-view .tree li:only-child::after { display: none; }
        .vertical-view .tree li:first-child::after { left: 50%; width: 50%; }
        .vertical-view .tree li:last-child::after { left: 0; width: 50%; }
        .vertical-view .tree li:has(> ul) > .card-wrapper::after {
            content: '';
            position: absolute;
            bottom: -25px;
            left: 50%;
            transform: translateX(-50%);
            width: 2px;
            height: 25px;
            background-color: var(--color-blue);
        }
        /* Ajustes Soporte */
        .vertical-view .tree li.support-role::before { display: none; }
        .vertical-view .tree li.support-role::after { background-color: var(--color-blue); }

        /* VISTA HORIZONTAL */
        .horizontal-view .tree-container {
            display: flex;
            align-items: center;
            padding: 2rem;
            min-width: 100%; /* Ajuste para responsive */
            overflow-x: auto;
        }
        .horizontal-view .gerente-col { position: relative; padding-right: 80px; }
        .horizontal-view .gerente-col::after {
            content: ''; position: absolute; top: 50%; right: 0; width: 40px; height: 2px; background-color: var(--color-blue);
        }
        .horizontal-view .jefes-col {
            position: relative; padding-left: 40px; display: flex; flex-direction: column; gap: 2rem;
        }
        .horizontal-view .jefes-col::before {
            content: ''; position: absolute; top: 0; left: 0; width: 2px; height: 100%; background-color: var(--color-blue);
        }
        .horizontal-view .jefe-item { position: relative; padding-left: 40px; display: flex; align-items: center; }
        .horizontal-view .jefe-item::before {
            content: ''; position: absolute; top: 50%; left: 0; width: 40px; height: 2px; background-color: var(--color-blue);
        }
        .horizontal-view .jefe-item.support-role::before { display: none; }
        .horizontal-view .ejecutivos-row {
            padding-left: 40px; display: grid; grid-template-columns: repeat(auto-fit, minmax(190px, 1fr)); gap: 1rem; align-items: stretch; width: 100%; max-width: 630px;
        }
        .horizontal-view .ejecutivos-row::before {
             content: ''; position: absolute; top: 50%; left: 0; width: 40px; height: 2px; background-color: var(--color-blue);
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.inset-0{inset:0px}.-right-3{right:-0.75rem}.-top-3{top:-0.75rem}.right-4{right:1rem}.top-4{top:1rem}.z-10{z-index:10}.z-20{z-index:20}.z-50{z-index:50}.m-0{margin:0px}.mx-auto{margin-left:auto;margin-right:auto}.-mt-6{margin-top:-1.5rem}.mb-1{margin-bottom:0.25rem}.mb-3{margin-bottom:0.75rem}.mb-6{margin-bottom:1.5rem}.mb-8{margin-bottom:2rem}.ml-3{margin-left:0.75rem}.mt-2{margin-top:0.5rem}.mt-8{margin-top:2rem}.mb-2{margin-bottom:0.5rem}.mt-1{margin-top:0.25rem}.block{display:block}.inline-block{display:inline-block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-12{height:3rem}.h-4{height:1rem}.h-5{height:1.25rem}.h-8{height:2rem}.h-\[300px\]{height:300px}.h-\[350px\]{height:350px}.h-16{height:4rem}.h-20{height:5rem}.max-h-\[90vh\]{max-height:90vh}.w-12{width:3rem}.w-4{width:1rem}.w-5{width:1.25rem}.w-8{width:2rem}.w-full{width:100%}.w-16{width:4rem}.w-20{width:5rem}.min-w-\[200px\]{min-width:200px}.min-w-full{min-width:100%}.max-w-7xl{max-width:80rem}.max-w-full{max-width:100%}.max-w-sm{max-width:24rem}.flex-1{flex:1 1 0%}.cursor-pointer{cursor:pointer}.list-disc{list-style-type:disc}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:0.25rem}.gap-2{gap:0.5rem}.gap-3{gap:0.75rem}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-3 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(0.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(0.75rem * var(--tw-space-y-reverse))}.space-y-6 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1.5rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1.5rem * var(--tw-space-y-reverse))}.space-y-8 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(2rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(2rem * var(--tw-space-y-reverse))}.overflow-hidden{overflow:hidden}.overflow-x-auto{overflow-x:auto}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:0.5rem}.rounded-md{border-radius:0.375rem}.rounded-xl{border-radius:0.75rem}.border{border-width:1px}.border-2{border-width:2px}.border-4{border-width:4px}.border-b{border-bottom-width:1px}.border-l-2{border-left-width:2px}.border-l-4{border-left-width:4px}.border-t-4{border-top-width:4px}.border-t-2{border-top-width:2px}.border-t-8{border-top-width:8px}.border-blue-100{--tw-border-opacity:1;border-color:rgb(219 234 254 / var(--tw-border-opacity, 1))}.border-gray-100{--tw-border-opacity:1;border-color:rgb(243 244 246 / var(--tw-border-opacity, 1))}.border-gray-200{--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity, 1))}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.border-green-100{--tw-border-opacity:1;border-color:rgb(220 252 231 / var(--tw-border-opacity, 1))}.border-green-400{--tw-border-opacity:1;border-color:rgb(74 222 128 / var(--tw-border-opacity, 1))}.border-indigo-100{--tw-border-opacity:1;border-color:rgb(224 231 255 / var(--tw-border-opacity, 1))}.border-indigo-500{--tw-border-opacity:1;border-color:rgb(99 102 241 / var(--tw-border-opacity, 1))}.border-orange-100{--tw-border-opacity:1;border-color:rgb(255 237 213 / var(--tw-border-opacity, 1))}.border-slate-100{--tw-border-opacity:1;border-color:rgb(241 245 249 / var(--tw-border-opacity, 1))}.border-white\/20{border-color:rgb(255 255 255 / 0.2)}.border-\[var\(--color-blue\)\]{border-color:var(--color-blue)}.border-\[var\(--color-yellow\)\]{border-color:var(--color-yellow)}.border-teal-500{--tw-border-opacity:1;border-color:rgb(20 184 166 / var(--tw-border-opacity, 1))}.bg-\[var\(--color-blue\)\]{background-color:var(--color-blue)}.bg-black{--tw-bg-opacity:1;background-color:rgb(0 0 0 / var(--tw-bg-opacity, 1))}.bg-blue-100{--tw-bg-opacity:1;background-color:rgb(219 234 254 / var(--tw-bg-opacity, 1))}.bg-blue-50{--tw-bg-opacity:1;background-color:rgb(239 246 255 / var(--tw-bg-opacity, 1))}.bg-gray-50{--tw-bg-opacity:1;background-color:rgb(249 250 251 / var(--tw-bg-opacity, 1))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231 / var(--tw-bg-opacity, 1))}.bg-green-50{--tw-bg-opacity:1;background-color:rgb(240 253 244 / var(--tw-bg-opacity, 1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94 / var(--tw-bg-opacity, 1))}.bg-indigo-50{--tw-bg-opacity:1;background-color:rgb(238 242 255 / var(--tw-bg-opacity, 1))}.bg-orange-50{--tw-bg-opacity:1;background-color:rgb(255 247 237 / var(--tw-bg-opacity, 1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68 / var(--tw-bg-opacity, 1))}.bg-slate-50{--tw-bg-opacity:1;background-color:rgb(248 250 252 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.bg-white\/10{background-color:rgb(255 255 255 / 0.1)}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226 / var(--tw-bg-opacity, 1))}.bg-opacity-70{--tw-bg-opacity:0.7}.bg-opacity-80{--tw-bg-opacity:0.8}.object-cover{object-fit:cover}.p-0{padding:0px}.p-1{padding:0.25rem}.p-2{padding:0.5rem}.p-3{padding:0.75rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.p-5{padding:1.25rem}.px-4{padding-left:1rem;padding-right:1rem}.px-5{padding-left:1.25rem;padding-right:1.25rem}.py-10{padding-top:2.5rem;padding-bottom:2.5rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.py-2\.5{padding-top:0.625rem;padding-bottom:0.625rem}.px-2{padding-left:0.5rem;padding-right:0.5rem}.py-0\.5{padding-top:0.125rem;padding-bottom:0.125rem}.pb-4{padding-bottom:1rem}.pb-8{padding-bottom:2rem}.pl-5{padding-left:1.25rem}.pl-8{padding-left:2rem}.text-center{text-align:center}.text-right{text-align:right}.align-top{vertical-align:top}.text-2xl{font-size:1.5rem;line-height:2rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:0.75rem;line-height:1rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-\[10px\]{font-size:10px}.text-base{font-size:1rem;line-height:1.5rem}.font-black{font-weight:900}.font-bold{font-weight:700}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.leading-relaxed{line-height:1.625}.tracking-tight{letter-spacing:-0.025em}.tracking-widest{letter-spacing:0.1em}.tracking-wider{letter-spacing:0.05em}.text-\[var\(--color-blue\)\]{color:var(--color-blue)}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235 / var(--tw-text-opacity, 1))}.text-blue-800{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-gray-800{--tw-text-opacity:1;color:rgb(31 41 55 / var(--tw-text-opacity, 1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity, 1))}.text-green-800{--tw-text-opacity:1;color:rgb(22 101 52 / var(--tw-text-opacity, 1))}.text-green-900{--tw-text-opacity:1;color:rgb(20 83 45 / var(--tw-text-opacity, 1))}.text-indigo-500{--tw-text-opacity:1;color:rgb(99 102 241 / var(--tw-text-opacity, 1))}.text-indigo-600{--tw-text-opacity:1;color:rgb(79 70 229 / var(--tw-text-opacity, 1))}.text-indigo-900{--tw-text-opacity:1;color:rgb(49 46 129 / var(--tw-text-opacity, 1))}.text-orange-500{--tw-text-opacity:1;color:rgb(249 115 22 / var(--tw-text-opacity, 1))}.text-orange-600{--tw-text-opacity:1;color:rgb(234 88 12 / var(--tw-text-opacity, 1))}.text-orange-900{--tw-text-opacity:1;color:rgb(124 45 18 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity, 1))}.text-teal-800{--tw-text-opacity:1;color:rgb(17 94 89 / var(--tw-text-opacity, 1))}.underline{-webkit-text-decoration-line:underline;text-decoration-line:underline}.opacity-80{opacity:0.8}.shadow-2xl{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-sm{--tw-shadow:0 1px 2px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.outline-none{outline:2px solid transparent;outline-offset:2px}.backdrop-blur-md{--tw-backdrop-blur:blur(12px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-colors{transition-property:color, background-color, border-color, fill, stroke, -webkit-text-decoration-color;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, -webkit-text-decoration-color;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.transition-shadow{transition-property:box-shadow;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.hover\:-translate-y-1:hover{--tw-translate-y:-0.25rem;transform:translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:bg-green-600:hover{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.hover\:bg-red-700:hover{--tw-bg-opacity:1;background-color:rgb(185 28 28 / var(--tw-bg-opacity, 1))}.hover\:bg-white\/20:hover{background-color:rgb(255 255 255 / 0.2)}.hover\:bg-opacity-90:hover{--tw-bg-opacity:0.9}.hover\:text-gray-300:hover{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.hover\:text-blue-800:hover{--tw-text-opacity:1;color:rgb(30 64 175 / var(--tw-text-opacity, 1))}.hover\:shadow-md:hover{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.hover\:shadow-2xl:hover{--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.focus\:border-\[var\(--color-blue\)\]:focus{border-color:var(--color-blue)}.focus\:border-blue-500:focus{--tw-border-opacity:1;border-color:rgb(59 130 246 / var(--tw-border-opacity, 1))}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow), var(--tw-ring-shadow), var(--tw-shadow, 0 0 #0000)}.focus\:ring-\[var\(--color-yellow\)\]:focus{--tw-ring-color:var(--color-yellow)}.focus\:ring-blue-500:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(59 130 246 / var(--tw-ring-opacity, 1))}@media (min-width: 640px){.sm\:w-1\/2{width:50%}.sm\:flex-row{flex-direction:row}}@media (min-width: 768px){.md\:mb-0{margin-bottom:0px}.md\:h-6{height:1.5rem}.md\:h-\[500px\]{height:500px}.md\:w-6{width:1.5rem}.md\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.md\:flex-row{flex-direction:row}.md\:justify-start{justify-content:flex-start}.md\:p-10{padding:2.5rem}.md\:p-6{padding:1.5rem}.md\:p-8{padding:2rem}.md\:px-6{padding-left:1.5rem;padding-right:1.5rem}.md\:py-2{padding-top:0.5rem;padding-bottom:0.5rem}.md\:text-left{text-align:left}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-3xl{font-size:1.875rem;line-height:2.25rem}.md\:text-base{font-size:1rem;line-height:1.5rem}.md\:text-sm{font-size:0.875rem;line-height:1.25rem}.md\:text-xl{font-size:1.25rem;line-height:1.75rem}.md\:text-lg{font-size:1.125rem;line-height:1.75rem}}@media (min-width: 1024px){.lg\:grid-cols-4{grid-template-columns:repeat(4, minmax(0, 1fr))}}</style></head>
<body class="p-0 m-0">

    <header class="gradient-header text-white p-8 shadow-lg relative">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center">
            <div class="mb-6 md:mb-0 text-center md:text-left">
                <div class="flex items-center gap-4 justify-center md:justify-start">
                    <div class="bg-white p-2 rounded-lg shadow-inner w-12 h-12 flex items-center justify-center">
                        <span class="text-blue-900 font-bold text-xl uppercase">MG</span>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-bold tracking-tight editable-focus" contenteditable="true" id="main-title">Informe Ejecutivo GAP</h1>
                        <p class="opacity-80 editable-focus text-sm md:text-base" contenteditable="true" id="main-subtitle">Informe que detalla resultados, logros y próximos objetivos</p>
                    </div>
                </div>
            </div>

            <!-- Selectores de Perfil y Botón Guardar -->
            <div class="flex flex-col md:flex-row gap-4 items-center">
                <div class="bg-white/10 p-1 rounded-full backdrop-blur-md border border-white/20 flex gap-1">
                    <!-- BOTÓN NUEVO: ¿Quiénes somos? -->
                    <button onclick="showAbout()" id="btn-about" class="px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition bg-white text-blue-900 shadow-lg">¿Quiénes somos?</button>
                    
                    <button onclick="switchProfile('user1')" id="btn-user1" class="px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white">Misael Gutiérrez</button>
                    <button onclick="switchProfile('user2')" id="btn-user2" class="px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white">Irain Verdugo</button>
                </div>
                
                <!-- BOTÓN PARA GUARDAR CAMBIOS -->
                <button onclick="saveAndDownloadHTML()" class="bg-green-500 hover:bg-green-600 text-white px-5 py-2.5 rounded-full text-xs md:text-sm font-bold transition flex items-center gap-2 shadow-lg border border-green-400">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                    Guardar Código
                </button>
            </div>
        </div>
    </header>

    <!-- SECCIÓN NUEVA: ¿Quiénes somos? -->
    <main id="about-section" class="max-w-7xl mx-auto p-4 md:p-6 space-y-8 -mt-6 relative z-10">
        <!-- Bloque de Misión y Funciones -->
        <section class="card p-6 md:p-10 mb-8">
            <h2 class="text-2xl md:text-3xl font-bold text-gray-800 mb-6">¿Quiénes somos?</h2>
            <p class="text-gray-600 leading-relaxed mb-8 editable-focus" contenteditable="true">
                Somos un equipo multidisciplinario dedicado a la atención integral del trabajador. Gestionamos todo el ciclo de servicio: desde la solución efectiva de aclaraciones hasta el despliegue de estrategias de contacto, asegurando siempre la excelencia operativa y la calidad humana en cada interacción.
            </p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-8">
                <!-- MISIÓN -->
                <div class="bg-blue-50 p-6 rounded-xl border border-blue-100">
                    <h3 class="text-xl font-bold text-blue-900 mb-3">Misión</h3>
                    <p class="text-blue-800 text-sm editable-focus" contenteditable="true">Garantizar la excelencia operativa en los canales de atención al público mediante la gestión estratégica de campañas y el estricto cumplimiento normativo de la CONSAR, transformando los requerimientos regulatorios y del negocio en experiencias de servicio memorables y de calidad para nuestros colaboradores.</p>
                </div>

                <!-- FUNCIONES -->
                <div class="bg-green-50 p-6 rounded-xl border border-green-100">
                    <h3 class="text-xl font-bold text-green-900 mb-3">Funciones</h3>
                    <ul class="text-green-800 text-sm list-disc pl-5 space-y-3 editable-focus" contenteditable="true">
                        <li><strong>Gestión Integral de la Atención:</strong> Administrar y resolver folios de Aclaración, Consulta y Quejas (2do nivel), así como coordinar la ejecución de campañas normativas y estratégicas de salida.</li>
                        <li><strong>Cumplimiento y Normatividad:</strong> Asegurar que tanto los procesos de atención CRM como los diálogos y layouts de campañas cumplan al 100% con las disposiciones de la CONSAR y políticas internas.</li>
                        <li><strong>Optimización de Procesos y Tiempos:</strong> Analizar métricas de ambos frentes (tiempos de respuesta en Salesforce y tasas de contactación en CAT) para implementar mejoras continuas que eleven el nivel de servicio.</li>
                        <li><strong>Coordinación Estratégica:</strong> Actuar como enlace clave entre las áreas de negocio (UNE, Operaciones) y los canales de ejecución (CAT, Módulos), garantizando que la información fluya correctamente hacia el trabajador.</li>
                        <li><strong>Análisis de Inteligencia de Servicio:</strong> Utilizar los datos obtenidos de las interacciones (quejas, consultas y resultados de campañas) para detectar áreas de oportunidad y proponer mejoras al negocio.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Bloque del Organigrama Interactivo -->
        <section class="card p-6 md:p-10 overflow-hidden">
            <div class="text-center mb-8">
                <h3 class="text-xl md:text-2xl font-bold text-[var(--color-blue)]">Organigrama Interactivo</h3>
                <p class="text-sm text-gray-500 mt-2">Gerencia de Atención al Público</p>
            </div>

            <!-- Controles Dinámicos -->
            <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-8 p-4 bg-gray-50 rounded-lg shadow-sm z-20 relative">
                <input type="text" id="search-box" placeholder="Buscar por nombre..." class="w-full sm:w-1/2 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[var(--color-yellow)] focus:border-[var(--color-blue)]">
                <button id="view-toggle" class="px-4 py-2 bg-[var(--color-blue)] text-white font-semibold rounded-lg hover:bg-opacity-90 transition-colors">
                    Cambiar a Vista Horizontal
                </button>
            </div>

            <!-- Contenedor del Organigrama -->
            <div id="org-chart-container" class="overflow-x-auto pb-8 text-center vertical-view">
                <!-- VISTA VERTICAL -->
                <div id="vertical-view" class="tree inline-block min-w-full align-top">
                     <ul style="position: relative;"><li id="li-kevin">
                <div class="card-wrapper" data-name="kevin zavala garcía" data-email="kevin.zavala@aforecoppel.com">
                    <div class="card-content bg-white rounded-lg shadow-lg p-4 border-t-8 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/80x80/002060/FFFFFF?text=KZ" alt="Fotografía de perfil de Kevin Zavala García" class="w-20 h-20 border-4 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/80x80/002060/FFFFFF?text=KZ'; this.onerror=null;">
                        <h3 class="font-bold text-lg text-[var(--color-blue)]">Kevin Zavala García</h3>
                        <p class="text-sm text-gray-600">Gerente de Atención al Público</p>
                        
                    </div>
                </div><ul><li id="li-irain">
                <div class="card-wrapper" data-name="irain alonso verdugo avila" data-email="irain.verdugo@aforecoppel.com" data-chief="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/002060/FFFFFF?text=IV" alt="Fotografía de perfil de Irain Alonso Verdugo Avila" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/64x64/002060/FFFFFF?text=IV'; this.onerror=null;">
                        <h3 class="font-bold text-md text-[var(--color-blue)]">Irain Alonso Verdugo Avila</h3>
                        <p class="text-sm text-gray-600">Jefe de Servicios</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">(ATN CRM Módulo, MAO, Formulario Web)</p>
                    </div>
                </div><ul><li id="li-gloria">
                <div class="card-wrapper" data-name="gloria alejandra sanchez ibarra" data-email="gloria.sanchez@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=GS" alt="Fotografía de perfil de Gloria Alejandra Sanchez Ibarra" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=GS'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Gloria Alejandra Sanchez Ibarra</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM MAO Monitoreos MAO</p>
                    </div>
                </div></li><li id="li-diana">
                <div class="card-wrapper" data-name="diana isbeth vega villa" data-email="diana.vega@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DV" alt="Fotografía de perfil de Diana Isbeth Vega Villa" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DV'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Diana Isbeth Vega Villa</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM MAO Monitoreos MAO</p>
                    </div>
                </div></li><li id="li-maria">
                <div class="card-wrapper" data-name="maria de los angeles leyva german" data-email="maria.leyva@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=ML" alt="Fotografía de perfil de Maria De Los Angeles Leyva German" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=ML'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Maria De Los Angeles Leyva German</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM MAO Monitoreos MAO</p>
                    </div>
                </div></li><li id="li-vianney">
                <div class="card-wrapper" data-name="vianney iracema castillo montano" data-email="vianney.castillo@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=VC" alt="Fotografía de perfil de Vianney Iracema Castillo Montano" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=VC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Vianney Iracema Castillo Montano</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM MAO &amp; CRM Formulario Web</p>
                    </div>
                </div></li><li id="li-carmen">
                <div class="card-wrapper" data-name="carmen francisca moreno acosta" data-email="carmen.moreno@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=CM" alt="Fotografía de perfil de Carmen Francisca Moreno Acosta" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=CM'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Carmen Francisca Moreno Acosta</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM Módulo Atención a consultas CRA</p>
                    </div>
                </div></li></ul></li><li id="li-sergio" class="support-role">
                <div class="card-wrapper" data-name="sergio antonio urieta caro" data-email="sergio.urieta@aforecoppel.com" data-team="irain misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-teal-500 cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/14B8A6/FFFFFF?text=SU" alt="Fotografía de perfil de Sergio Antonio Urieta Caro" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-teal-500 object-cover" onerror="this.src='https://placehold.co/64x64/14B8A6/FFFFFF?text=SU'; this.onerror=null;">
                        <h3 class="font-bold text-md text-teal-800">Sergio Antonio Urieta Caro</h3>
                        <p class="text-sm text-gray-600">Soporte de Jefes de Servicio</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">Seguimientos Especiales CRM</p>
                    </div>
                </div></li><li id="li-misael">
                <div class="card-wrapper" data-name="jesus misael gutierrez nuñez" data-email="jesus.gutierrez@aforecoppel.com" data-chief="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/002060/FFFFFF?text=JG" alt="Fotografía de perfil de Jesus Misael Gutierrez Nuñez" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/64x64/002060/FFFFFF?text=JG'; this.onerror=null;">
                        <h3 class="font-bold text-md text-[var(--color-blue)]">Jesus Misael Gutierrez Nuñez</h3>
                        <p class="text-sm text-gray-600">Jefe de Servicios</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">(Servicios CAT &amp; ATN CRM CAT)</p>
                    </div>
                </div><ul><li id="li-jesus-noe">
                <div class="card-wrapper" data-name="jesús noé pinedo beltran" data-email="jesus.pinedo@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=JP" alt="Fotografía de perfil de Jesús Noé Pinedo Beltran" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=JP'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Jesús Noé Pinedo Beltran</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM CAT Datos CAT</p>
                    </div>
                </div></li><li id="li-jesus">
                <div class="card-wrapper" data-name="jesús keanu canedo soto" data-email="jesus.canedo@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=JC" alt="Fotografía de perfil de Jesús Keanu Canedo Soto" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=JC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Jesús Keanu Canedo Soto</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM CAT Diálogos y Capacitación CAT</p>
                    </div>
                </div></li><li id="li-dania">
                <div class="card-wrapper" data-name="dania chávez" data-email="dania.chavez@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DC" alt="Fotografía de perfil de Dania Chávez" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Dania Chávez</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM CAT MPP y Capacitación CAT</p>
                    </div>
                </div></li><li id="li-domenika">
                <div class="card-wrapper" data-name="domenika guadalupe felix castro" data-email="domenika.felix@aforecoppel.com" data-team="undefined">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DF" alt="Fotografía de perfil de Domenika Guadalupe Felix Castro" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DF'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Domenika Guadalupe Felix Castro</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        <p class="text-xs font-semibold text-gray-700 mt-1">CRM CAT &amp; Seguimiento al cumplimiento MPP</p>
                    </div>
                </div></li></ul></li></ul></li><svg class="org-lines" style="position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; pointer-events: none; z-index: 0;"><path d="M 1090 394 L 678.875 364" stroke="var(--color-blue)" stroke-width="2" fill="transparent" stroke-dasharray="5, 5"></path><path d="M 1280 394 L 1591.59375 364" stroke="var(--color-blue)" stroke-width="2" fill="transparent" stroke-dasharray="5, 5"></path></svg></ul>
                </div>
                <!-- VISTA HORIZONTAL -->
                <div id="horizontal-view" class="tree-container hidden"><div class="gerente-col">
                <div class="card-wrapper" data-name="kevin zavala garcía" data-email="kevin.zavala@aforecoppel.com">
                    <div class="card-content bg-white rounded-lg shadow-lg p-4 border-t-8 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/80x80/002060/FFFFFF?text=KZ" alt="Fotografía de perfil de Kevin Zavala García" class="w-20 h-20 border-4 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/80x80/002060/FFFFFF?text=KZ'; this.onerror=null;">
                        <h3 class="font-bold text-lg text-[var(--color-blue)]">Kevin Zavala García</h3>
                        <p class="text-sm text-gray-600">Gerente de Atención al Público</p>
                        
                    </div>
                </div></div><div class="jefes-col"><div id="h-li-irain" class="jefe-item ">
                <div class="card-wrapper" data-name="irain alonso verdugo avila" data-email="irain.verdugo@aforecoppel.com" data-chief="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/002060/FFFFFF?text=IV" alt="Fotografía de perfil de Irain Alonso Verdugo Avila" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/64x64/002060/FFFFFF?text=IV'; this.onerror=null;">
                        <h3 class="font-bold text-md text-[var(--color-blue)]">Irain Alonso Verdugo Avila</h3>
                        <p class="text-sm text-gray-600">Jefe de Servicios</p>
                        
                    </div>
                </div><div class="ejecutivos-row">
                <div class="card-wrapper" data-name="gloria alejandra sanchez ibarra" data-email="gloria.sanchez@aforecoppel.com" data-team="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=GS" alt="Fotografía de perfil de Gloria Alejandra Sanchez Ibarra" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=GS'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Gloria Alejandra Sanchez Ibarra</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="diana isbeth vega villa" data-email="diana.vega@aforecoppel.com" data-team="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DV" alt="Fotografía de perfil de Diana Isbeth Vega Villa" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DV'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Diana Isbeth Vega Villa</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="maria de los angeles leyva german" data-email="maria.leyva@aforecoppel.com" data-team="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=ML" alt="Fotografía de perfil de Maria De Los Angeles Leyva German" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=ML'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Maria De Los Angeles Leyva German</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="vianney iracema castillo montano" data-email="vianney.castillo@aforecoppel.com" data-team="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=VC" alt="Fotografía de perfil de Vianney Iracema Castillo Montano" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=VC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Vianney Iracema Castillo Montano</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="carmen francisca moreno acosta" data-email="carmen.moreno@aforecoppel.com" data-team="irain">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=CM" alt="Fotografía de perfil de Carmen Francisca Moreno Acosta" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=CM'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Carmen Francisca Moreno Acosta</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div></div></div><div id="h-li-sergio" class="jefe-item support-role">
                <div class="card-wrapper" data-name="sergio antonio urieta caro" data-email="sergio.urieta@aforecoppel.com" data-team="irain misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-teal-500 cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/14B8A6/FFFFFF?text=SU" alt="Fotografía de perfil de Sergio Antonio Urieta Caro" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-teal-500 object-cover" onerror="this.src='https://placehold.co/64x64/14B8A6/FFFFFF?text=SU'; this.onerror=null;">
                        <h3 class="font-bold text-md text-teal-800">Sergio Antonio Urieta Caro</h3>
                        <p class="text-sm text-gray-600">Soporte de Jefes de Servicio</p>
                        
                    </div>
                </div></div><div id="h-li-misael" class="jefe-item ">
                <div class="card-wrapper" data-name="jesus misael gutierrez nuñez" data-email="jesus.gutierrez@aforecoppel.com" data-chief="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-4 border-[var(--color-blue)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/002060/FFFFFF?text=JG" alt="Fotografía de perfil de Jesus Misael Gutierrez Nuñez" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-blue)] object-cover" onerror="this.src='https://placehold.co/64x64/002060/FFFFFF?text=JG'; this.onerror=null;">
                        <h3 class="font-bold text-md text-[var(--color-blue)]">Jesus Misael Gutierrez Nuñez</h3>
                        <p class="text-sm text-gray-600">Jefe de Servicios</p>
                        
                    </div>
                </div><div class="ejecutivos-row">
                <div class="card-wrapper" data-name="jesús noé pinedo beltran" data-email="jesus.pinedo@aforecoppel.com" data-team="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=JP" alt="Fotografía de perfil de Jesús Noé Pinedo Beltran" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=JP'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Jesús Noé Pinedo Beltran</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="jesús keanu canedo soto" data-email="jesus.canedo@aforecoppel.com" data-team="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=JC" alt="Fotografía de perfil de Jesús Keanu Canedo Soto" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=JC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Jesús Keanu Canedo Soto</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="dania chávez" data-email="dania.chavez@aforecoppel.com" data-team="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DC" alt="Fotografía de perfil de Dania Chávez" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DC'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Dania Chávez</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div>
                <div class="card-wrapper" data-name="domenika guadalupe felix castro" data-email="domenika.felix@aforecoppel.com" data-team="misael">
                    <div class="card-content bg-white rounded-lg shadow-lg p-3 border-t-2 border-[var(--color-yellow)] cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="https://placehold.co/64x64/FFD966/000000?text=DF" alt="Fotografía de perfil de Domenika Guadalupe Felix Castro" class="w-16 h-16 border-2 rounded-full mx-auto mb-3 border-[var(--color-yellow)] object-cover" onerror="this.src='https://placehold.co/64x64/FFD966/000000?text=DF'; this.onerror=null;">
                        <h3 class="font-bold text-sm text-[var(--color-blue)]">Domenika Guadalupe Felix Castro</h3>
                        <p class="text-sm text-gray-600">Ejecutivo de Atención</p>
                        
                    </div>
                </div></div></div></div></div>
            </div>
        </section>
    </main>

    <!-- Modals Organigrama -->
    <div id="zoomModal" class="fixed inset-0 bg-black bg-opacity-70 hidden items-center justify-center p-4 z-50">
        <div id="modalContent" class="bg-white rounded-lg shadow-2xl p-6 relative max-w-sm w-full text-center">
            <button id="closeModal" class="absolute -top-3 -right-3 text-white bg-red-500 rounded-full h-8 w-8 flex items-center justify-center text-lg font-bold hover:bg-red-700">×</button>
        </div>
    </div>
    <div id="imageZoomModal" class="fixed inset-0 bg-black bg-opacity-80 hidden items-center justify-center p-4 z-50">
        <button id="closeImageModal" class="absolute top-4 right-4 text-white text-4xl font-bold hover:text-gray-300">×</button>
        <img id="zoomedImage" src="" alt="Vista ampliada" class="max-w-full max-h-[90vh] rounded-lg shadow-lg">
    </div>

    <!-- DASHBOARD PRINCIPAL (Ahora con ID para poder ocultarlo/mostrarlo) -->
    <main id="dashboard-section" class="max-w-7xl mx-auto p-4 md:p-6 space-y-8 -mt-6 relative z-10 hidden">

        <!-- SECCIÓN NUEVA: Volumen de Atenciones -->
        <!-- Se agregó el ID "volume-section" para poder ocultarlo dinámicamente -->
        <section id="volume-section" class="card p-4 md:p-8 mb-8 border-l-4 border-indigo-500 hidden">
            <div class="flex flex-col md:flex-row justify-between items-start mb-6 border-b pb-4">
                <div>
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800">Volumen de Atenciones CAT</h2>
                    <p class="text-sm text-gray-500">Seguimiento numérico mensual • Drive A9:M10</p>
                </div>
            </div>

            <!-- FILTROS DE VOLUMEN (NUEVO) -->
            <div class="flex flex-wrap gap-4 mb-6 bg-slate-50 p-4 rounded-xl border border-slate-100">
                <div class="flex-1 min-w-[200px]">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Filtrar Canal</label>
                     <select id="filter-volume-channel" onchange="updateVolumeChartDisplay()" class="w-full p-2 text-sm bg-white border-gray-200 rounded-md focus:border-blue-500 focus:ring-blue-500 shadow-sm outline-none border transition-colors cursor-pointer text-gray-700">
                         <option value="all">Todos los Canales</option>
                         <option value="inbound">Llamadas Inbound</option>
                         <option value="outbound">Llamadas Outbound</option>
                     </select>
                </div>
                <div class="flex-1 min-w-[200px]">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Filtrar Mes</label>
                     <select id="filter-volume-month" onchange="updateVolumeChartDisplay()" class="w-full p-2 text-sm bg-white border-gray-200 rounded-md focus:border-blue-500 focus:ring-blue-500 shadow-sm outline-none border transition-colors cursor-pointer text-gray-700">
                         <option value="all">Vista General</option>
                         <!-- Se llena dinámicamente -->
                     <option value="0">Ene</option><option value="1">Feb</option><option value="2">Mar</option><option value="3">Abr</option><option value="4">May</option><option value="5">Jun</option><option value="6">Jul</option><option value="7">Ago</option><option value="8">Sep</option><option value="9">Oct</option><option value="10">Nov</option><option value="11">Dic</option></select>
                </div>
            </div>

            <!-- Tarjetas de Sumatoria Anual -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-indigo-50 p-6 rounded-xl border border-indigo-100 flex justify-between items-center shadow-sm">
                    <div>
                        <p class="text-xs font-bold text-indigo-500 uppercase tracking-widest mb-1">Total Inbound Anual</p>
                        <h3 class="text-4xl font-black text-indigo-900" id="total-inbound">231,982</h3>
                    </div>
                    <div class="bg-white p-3 rounded-full shadow-inner">
                        <svg class="w-8 h-8 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
                    </div>
                </div>
                <div class="bg-orange-50 p-6 rounded-xl border border-orange-100 flex justify-between items-center shadow-sm">
                    <div>
                        <p class="text-xs font-bold text-orange-500 uppercase tracking-widest mb-1">Total Outbound Anual</p>
                        <h3 class="text-4xl font-black text-orange-900" id="total-outbound">2,552,266</h3>
                    </div>
                    <div class="bg-white p-3 rounded-full shadow-inner">
                        <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path></svg>
                    </div>
                </div>
            </div>

            <!-- Gráfica de Volumen -->
            <div class="h-[300px] w-full">
                <canvas id="volumeChart" width="1048" height="300" style="display: block; box-sizing: border-box; height: 300px; width: 1048px;"></canvas>
            </div>
        </section>

        <!-- Sección Principal (Indicadores Porcentuales) -->
        <section class="card p-4 md:p-8">
            <div class="flex flex-col md:flex-row justify-between items-start mb-6 border-b pb-4">
                <div>
                    <h2 class="text-xl md:text-2xl font-bold text-gray-800" id="chart-title">Atención a CRM's MSO, Tienda, Formulario Web y Quejas</h2>
                    <!-- Placeholder ID para subtítulo -->
                    <p class="text-sm text-gray-500" id="chart-subtitle">Jefatura de Servicios - Gerencia de Atención al Público</p>
                </div>
            </div>

            <!-- Controles de Filtro -->
            <div class="flex flex-wrap gap-4 mb-8 bg-slate-50 p-4 rounded-xl border border-slate-100">
                <div class="flex-1 min-w-[200px]">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1">Filtrar Indicador</label>
                     <select id="filter-indicator" onchange="updateChartDisplay()" class="w-full p-2 text-sm bg-white border-gray-200 rounded-md focus:border-blue-500 focus:ring-blue-500 shadow-sm outline-none border transition-colors cursor-pointer text-gray-700"><option value="all">Todos los Indicadores</option><option value="0">Atención a Quejas</option><option value="1">Folios Históricos Abiertos (MSO)</option></select>
                </div>
                <div class="flex-1 min-w-[200px]">
                     <label class="block text-xs font-bold text-gray-500 uppercase mb-1" id="filter-xaxis-label">Filtrar Mes / Eje</label>
                     <select id="filter-xaxis" onchange="updateChartDisplay()" class="w-full p-2 text-sm bg-white border-gray-200 rounded-md focus:border-blue-500 focus:ring-blue-500 shadow-sm outline-none border transition-colors cursor-pointer text-gray-700"><option value="all">Vista General</option><option value="0">Oct-24</option><option value="1">Nov-24</option><option value="2">Dic-24</option><option value="3">Ene-25</option><option value="4">Feb-25</option><option value="5">Mar-25</option><option value="6">Abr-25</option><option value="7">May-25</option><option value="8">Jun-25</option><option value="9">Jul-25</option><option value="10">Ago-25</option><option value="11">Sep-25</option><option value="12">Oct-25</option><option value="13">Nov-25</option><option value="14">Dic-25</option><option value="15">Ene-26</option></select>
                </div>
            </div>

            <!-- NUEVA SECCIÓN DE KPIs: Promedios Semestrales -->
            <div id="kpi-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                    <div class="bg-white p-5 rounded-xl border-t-4 shadow-sm hover:shadow-md transition-shadow relative" style="border-color: #16a34a">
                        <div class="flex justify-between items-start mb-2">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Atención a Quejas</p>
                            <span class="bg-green-100 text-green-600 text-[10px] px-2 py-0.5 rounded-full font-bold flex items-center gap-1">↓ 4%</span>
                        </div>
                        <h3 class="text-3xl font-black text-gray-800">33.00</h3>
                        <div class="flex justify-between items-end mt-2">
                            <p class="text-[10px] text-gray-400">Gestión Actual vs Previo (Oct-24)</p>
                            <div class="text-right">
                                <span class="block text-[10px] font-bold text-gray-400 uppercase">Meta</span>
                                <span class="text-sm font-bold text-blue-900">30%</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border-t-4 shadow-sm hover:shadow-md transition-shadow relative" style="border-color: #16a34a">
                        <div class="flex justify-between items-start mb-2">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">Folios Históricos Abiertos (MSO)</p>
                            <span class="bg-green-100 text-green-600 text-[10px] px-2 py-0.5 rounded-full font-bold flex items-center gap-1">↓ 14%</span>
                        </div>
                        <h3 class="text-3xl font-black text-gray-800">209.00</h3>
                        <div class="flex justify-between items-end mt-2">
                            <p class="text-[10px] text-gray-400">Gestión 25/26 vs Cierre 2024</p>
                            <div class="text-right">
                                <span class="block text-[10px] font-bold text-gray-400 uppercase">Meta</span>
                                <span class="text-sm font-bold text-blue-900">150%</span>
                            </div>
                        </div>
                    </div></div>

            <!-- Gráfica -->
            <div class="h-[350px] md:h-[500px] w-full bg-slate-50 rounded-lg p-2 border border-slate-100">
                <canvas id="mainChart" style="box-sizing: border-box; display: block; height: 482px; width: 1034px;" width="1034" height="482"></canvas>
            </div>
        </section>

        <!-- Bloques de Texto: Logros y Roadmap -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <section class="card p-6 md:p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-green-100 p-2 rounded-full">
                        <svg class="w-5 h-5 md:w-6 md:h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    </div>
                    <h2 class="text-lg md:text-xl font-bold text-gray-800">Logros Destacados</h2>
                </div>
                <ul id="achievements-list" class="space-y-6">
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Reducción Histórica de Quejas</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Disminución notable en la tendencia mensual tras asumir la Jefatura en Nov 2024.</p>
                </li>
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Control de Folios MSO</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Reducción sostenida de folios históricos desde el pico de Diciembre 2024.</p>
                </li>
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Mejoras en CRM</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Se implementaron mejoras dentro de la plataforma CRM que impacta en la resolución de folios.</p>
                </li>
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Uso de IA</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Se implementaron mejoras con Uso de IA que impacta en solución de primer nivel y capacitaciones que permiten mejorar la calidad de la atención.</p>
                </li>
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Looker de Quejas</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Monitoreo de quejas con el objetivo de lograr reducción de las mismas.</p>
                </li></ul>
            </section>

            <section class="card p-6 md:p-8">
                <div class="flex items-center gap-3 mb-6">
                    <div class="bg-blue-100 p-2 rounded-full">
                        <svg class="w-5 h-5 md:w-6 md:h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path></svg>
                    </div>
                    <h2 class="text-lg md:text-xl font-bold text-gray-800">Próximos Objetivos</h2>
                </div>
                <div id="roadmap-container" class="border-l-2 border-gray-100 ml-3 space-y-8 relative">
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Mantener la resolución de MSO a la par del ingreso de nuevos folios.</h3>
                    
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">PRIMER SEMESTRE 2026</span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Auditoría de calidad para mantener quejas por debajo de la meta de 30.</h3>
                    
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">JUNIO 2026</span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Lograr el 100% de Certificación ECAP para el Q3</h3>
                    
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Q3 (JULIO-SEPTIEMBRE)</span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Visitas bimestrales a tiendas con módulo de Asesor Previsional</h3>
                    <p class="text-sm text-gray-600 mt-2 mb-1 editable-focus" contenteditable="true">El objetivo es impactar en la atención de nuestros clientes, buscando encontrar áreas de oportunidad.</p>
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true"></span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Generar Integración del QA a Salesforce.</h3>
                    <p class="text-sm text-gray-600 mt-2 mb-1 editable-focus" contenteditable="true">Mejorar en los indicadores clave NPS, TCR, Amabilidad, Solución de primer contacto, monitoreando y reduciendo tiempos de atención en casos escalados a los institutos.</p>
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true"></span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Anexo de Biblioteca de Marcas a la Base de Conocimientos Servicios</h3>
                    <p class="text-sm text-gray-600 mt-2 mb-1 editable-focus" contenteditable="true">Con esta Biblioteca se unificaran las respuestas de cada una de las marcas, homologando la información y el objetivo es impactar en los siguientes indicadores: NPS, TCR, Amabilidad y reducción de escalamiento de folios.</p>
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Q1 (ENERO-MARZO)</span>
                </div>
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">Medición del Nivel de Escalamiento de los N1's</h3>
                    <p class="text-sm text-gray-600 mt-2 mb-1 editable-focus" contenteditable="true">El objetivo es reducir el % de escalamiento, logrando identificar áreas de oportunidad.</p>
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">Q1 (ENERO-MARZO)</span>
                </div></div>
            </section>
        </div>

        <footer class="text-center text-gray-400 py-10 text-xs md:text-sm">
            <p>Vista ejecutiva interactiva • Datos actualizados conforme a Drive corporativo</p>
        </footer>
    </main>

    <script>
        // Registrar el plugin de etiquetas
        Chart.register(ChartDataLabels);

        const months = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];

        // --- DATOS_INICIO ---
        let profiles = {
          "user1": {
                    "name": "Misael Gutiérrez",
                    "chartType": "line",
                    "volumeData": {
                              "inbound": [
                                        23529,
                                        20234,
                                        21287,
                                        21142,
                                        19872,
                                        18163,
                                        19860,
                                        18500,
                                        18711,
                                        19996,
                                        15851,
                                        14837
                              ],
                              "outbound": [
                                        422312,
                                        42078,
                                        203184,
                                        168285,
                                        47557,
                                        189479,
                                        311741,
                                        186458,
                                        114893,
                                        277512,
                                        510894,
                                        77873
                              ]
                    },
                    "chartData": {
                              "labels": [
                                        "Ene",
                                        "Feb",
                                        "Mar",
                                        "Abr",
                                        "May",
                                        "Jun",
                                        "Jul",
                                        "Ago",
                                        "Sep",
                                        "Oct",
                                        "Nov",
                                        "Dic"
                              ],
                              "datasets": [
                                        {
                                                  "label": "NPS CAT",
                                                  "data": [
                                                            56.02,
                                                            46.95,
                                                            55.34,
                                                            56.77,
                                                            55.2,
                                                            63.35,
                                                            83.36,
                                                            85.12,
                                                            88.03,
                                                            89.44,
                                                            88.68,
                                                            89.53
                                                  ],
                                                  "meta": 83,
                                                  "borderColor": "#1e3a8a",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#1e3a8a",
                                                  "tension": 0.3,
                                                  "fill": false,
                                                  "borderWidth": 3,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "Amabilidad",
                                                  "data": [
                                                            89.86,
                                                            86.25,
                                                            87.15,
                                                            86.54,
                                                            88.01,
                                                            87.1,
                                                            86.06,
                                                            91.28,
                                                            91.26,
                                                            92.02,
                                                            91.65,
                                                            92.48
                                                  ],
                                                  "meta": 95,
                                                  "borderColor": "#10b981",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#10b981",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "TCR",
                                                  "data": [
                                                            93.7,
                                                            93.74,
                                                            93.17,
                                                            93.26,
                                                            92.6,
                                                            98.05,
                                                            93.41,
                                                            95.51,
                                                            95.67,
                                                            95.4,
                                                            95.98,
                                                            96.17
                                                  ],
                                                  "meta": 97,
                                                  "borderColor": "#f59e0b",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#f59e0b",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "Nivel Servicio",
                                                  "data": [
                                                            98.38,
                                                            98.6,
                                                            97.83,
                                                            97.84,
                                                            97.72,
                                                            99.24,
                                                            96.2,
                                                            97.09,
                                                            97.86,
                                                            94.46,
                                                            98,
                                                            99.14
                                                  ],
                                                  "meta": 95,
                                                  "borderColor": "#6366f1",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#6366f1",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "% Contacto",
                                                  "data": [
                                                            7.84,
                                                            40.06,
                                                            19.7,
                                                            20.35,
                                                            34.15,
                                                            14.78,
                                                            21.41,
                                                            25.01,
                                                            34.28,
                                                            15.5,
                                                            10.56,
                                                            28.03
                                                  ],
                                                  "borderColor": "#8b5cf6",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#8b5cf6",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "% Efectividad",
                                                  "data": [
                                                            4.13,
                                                            11.46,
                                                            2.6,
                                                            3.44,
                                                            16.51,
                                                            5.8,
                                                            6.71,
                                                            8.29,
                                                            11.12,
                                                            5.1,
                                                            3.25,
                                                            10.89
                                                  ],
                                                  "borderColor": "#ec4899",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#ec4899",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        },
                                        {
                                                  "label": "% Abandono",
                                                  "data": [
                                                            0.49,
                                                            0.41,
                                                            0.4,
                                                            0.44,
                                                            0.93,
                                                            0.93,
                                                            0.81,
                                                            0.63,
                                                            0.53,
                                                            2.28,
                                                            0.78,
                                                            0.17
                                                  ],
                                                  "borderColor": "#f43f5e",
                                                  "backgroundColor": "transparent",
                                                  "pointBackgroundColor": "#f43f5e",
                                                  "tension": 0.3,
                                                  "borderWidth": 2,
                                                  "borderDash": [
                                                            5,
                                                            5
                                                  ]
                                        }
                              ]
                    },
                    "achievements": [
                              {
                                        "title": "Dashboard MPP",
                                        "desc": "Seguimiento de cursos dentro del <a href=\"https://sites.google.com/aforecoppel.com/cataforecoppel/cumplimiento-cursos-mpp?authuser=0\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">MPP</a> numeral 8.<br><strong>Impacto en el % de cumplimiento de los cursos MPP</strong>"
                              },
                              {
                                        "title": "Implementación de citas - CAT",
                                        "desc": "El ejecutivo CAT esta habilitado para brindar citas durante la llamada.<br><strong>Impacta en los indicadores de: NPS, TCR.</strong>"
                              },
                              {
                                        "title": "Implementación de entrega de EDC - CAT",
                                        "desc": "El ejecutivo CAT esta habilitado para brindar EDC durante la llamada. Con esta iniciativa se logró una reducción del 90% de casos <a href=\"https://afore-coppel.lightning.force.com/lightning/r/Report/00OTQ000006oEcD2AU/view\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">escalados</a> en segundo nivel.<br><strong>Impacta en los indicadores de: NPS, TCR.</strong>"
                              },
                              {
                                        "title": "Implementación de diálogo Beway - CAT",
                                        "desc": "Se establece un diálogo que esta conformado con ciencias del comportamiento que nos permitió un incremento de 6.89% durante el <a href=\"https://docs.google.com/presentation/d/1Q8yU55nxSpyikqWYzdCFFfY6CCLyxpfhS_msut7tgWk/edit?slide=id.g38647c474da_0_17#slide=id.g38647c474da_0_17\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">experimento</a>."
                              },
                              {
                                        "title": "Reportería por horarios de contactación",
                                        "desc": "Se solicitó una <a href=\"https://docs.google.com/spreadsheets/d/1dBW6pNAswXKhItdwX-JmdwYIItlOLAFhox2fpr7-hq0/edit?gid=528552890#gid=528552890\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">reportería</a> por campaña que nos permita identificar en qué horarios tenemos más contacto y efectividad con nuestros clientes.<br><strong>Impacta en los indicadores de: %Contacto y Efectividad</strong>"
                              },
                              {
                                        "title": "Micrositio - CAT",
                                        "desc": "Se realizó un <a href=\"https://sites.google.com/aforecoppel.com/cataforecoppel/portal-de-inicio\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">micrositio</a> que permite la concentración de información en CAT."
                              },
                              {
                                        "title": "Herramienta generadora de avisos",
                                        "desc": "Creación e integración de herramienta generadora de avisos dentro del <a href=\"https://sites.google.com/aforecoppel.com/cataforecoppel/portal-de-inicio\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">micrositio</a> para agilizar la comunicación operativa."
                              },
                              {
                                        "title": "Confirmación en la pregunta de encuesta NPS",
                                        "desc": "Se integró una confirmación en la pregunta NPS que nos permitió aumenta aproximadamente 28% de Mayo a Julio."
                              },
                              {
                                        "title": "Herramienta generadora de rechazos bancarios",
                                        "desc": "Se genero una <a href=\"https://sites.google.com/aforecoppel.com/cataforecoppel/rechazos-bancarios?authuser=0\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">herramienta</a> que permite que los ejecutivos GAP-CAT transmitan una respuesta mediante imagen.<br><strong>Impacta en los indicadores de: NPS, TCR.</strong>"
                              },
                              {
                                        "title": "Recuperación de 90% rechazos bancarios",
                                        "desc": "Se logra una recuperación que oscila entre el 90% en recuperación de rechazos bancarios."
                              },
                              {
                                        "title": "Blaster 57+",
                                        "desc": "Se realiza un blaster para abarcar las campañas del Plan 57+ permitiendo agilizar el proceso de contactación."
                              },
                              {
                                        "title": "Blaster Asignados",
                                        "desc": "Se realiza un blaster para abarcar las campañas del Asignados Sartel y Oficios permitiendo agilizar el proceso de contactación."
                              }
                    ],
                    "roadmap": [
                              {
                                        "goal": "Monitor de avisos en pantallas CAT",
                                        "desc": "El objetivo es Transmitir y Agilizar el envío de la información más reciente a la línea de operación impactando en el NPS, AMABILIDAD y TCR.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Generar una herramienta que permita hacer un análisis de contactación por Hora.",
                                        "desc": "El objetivo de esta herramienta es impactar de manera estratégica en los indicadores de: %Contactos y %Efectividad.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Participación en Biblioteca de Marcas - CAT",
                                        "desc": "Con esta Biblioteca se unificaran las respuestas de cada una de las marcas, homologando la información y el objetivo es Impactar en los siguientes indicadores: NPS, TCR, Amabilidad y reducción de escalamiento de folios.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Medición del nivel de escalamiento",
                                        "desc": "El objetivo es reducir el % de escalamiento, logrando identificar áreas de oportunidad.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Blaster Rechazo Bancario (Anticipación - Recordatorio)",
                                        "desc": "El objetivo es cambiar el % de efectividad de nuestra campaña.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Implementar experimento servicio al cliente Veracruz <a href=\"https://gap-aforecoppel.github.io/Servicio-al-cliente-Veracruz/\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">herramienta</a>",
                                        "desc": "El objetivo es mejorar el % retención del estado.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Reducción de folios de estatus de retiro",
                                        "desc": "Reducir mínimo el 10% de folios escalados por estatus.",
                                        "date": "Q2 (ABRIL-JUNIO)"
                              },
                              {
                                        "goal": "<a href=\"https://drive.google.com/file/d/1uiYsyL8e347RvW9h-sUBXpDgVz9Y6pap/view?usp=sharing\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">Repositorio</a> de indicadores Inbound/Outbound - AutoServicio",
                                        "desc": "Monitorear el comportamiento de nuestros indicadores clave.<br><strong>Nota:</strong> Esto no mejora directamente, pero si es una buena vista que permite accionar de acuerdo al comportamiento del dia a dia.",
                                        "date": "Q2 (ABRIL-JUNIO)"
                              },
                              {
                                        "goal": "Dashboard de indicadores de calidad",
                                        "desc": "Aumentar el % de monitoreo de calidad, identificando áreas de oportunidad.",
                                        "date": "Q2 (ABRIL-JUNIO)"
                              },
                              {
                                        "goal": "Reactivar la base de datos directorio afore.",
                                        "desc": "Mejorar la calidad de nuestros números telefónicos y con ello impactar en nuestros indicadores %Contacto.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Integración de <a href=\"https://docs.google.com/presentation/d/1WtrjAZfqYfMLsN_cc4X9GWqiK700dvzVZg-hIREyWas/edit?slide=id.p1#slide=id.p1\" target=\"_blank\" class=\"text-blue-600 font-bold hover:text-blue-800 underline transition-colors\" contenteditable=\"false\">QA</a> en Salesforce",
                                        "desc": "Mejorar en los indicadores clave NPS, TCR, Amabilidad, Solución de primer contacto, orientando al trabajador e identificando la situación actual de nuestro cliente.",
                                        "date": "Q2 (ABRIL-JUNIO)"
                              },
                              {
                                        "goal": "Línea Alto Valor",
                                        "desc": "Mejorar la retención de nuestros clientes que generan mayor rentabilidad para el negocio.",
                                        "date": "Q2 (ABRIL-JUNIO)"
                              }
                    ]
          },
          "user2": {
                    "name": "Irain Verdugo",
                    "customTitle": "Atención a CRM's MSO, Tienda, Formulario Web y Quejas",
                    "customSubtitle": "Jefatura de Servicios - Gerencia de Atención al Público",
                    "chartType": "line",
                    "unit": "",
                    "inverseTrend": true,
                    "volumeData": {
                              "inbound": [],
                              "outbound": []
                    },
                    "chartData": {
                              "labels": [
                                        "Oct-24",
                                        "Nov-24",
                                        "Dic-24",
                                        "Ene-25",
                                        "Feb-25",
                                        "Mar-25",
                                        "Abr-25",
                                        "May-25",
                                        "Jun-25",
                                        "Jul-25",
                                        "Ago-25",
                                        "Sep-25",
                                        "Oct-25",
                                        "Nov-25",
                                        "Dic-25",
                                        "Ene-26"
                              ],
                              "datasets": [
                                        {
                                                  "label": "Atención a Quejas",
                                                  "data": [
                                                            204,
                                                            84,
                                                            93,
                                                            83,
                                                            50,
                                                            68,
                                                            64,
                                                            47,
                                                            51,
                                                            49,
                                                            51,
                                                            44,
                                                            48,
                                                            31,
                                                            37,
                                                            33
                                                  ],
                                                  "meta": 30,
                                                  "beforeIndex": 1,
                                                  "kpiSubtitle": "Gestión Actual vs Previo (Oct-24)",
                                                  "backgroundColor": "transparent",
                                                  "tension": 0.3,
                                                  "fill": false,
                                                  "borderWidth": 3,
                                                  "segment": {}
                                        },
                                        {
                                                  "label": "Folios Históricos Abiertos (MSO)",
                                                  "customLabels": [
                                                            "S49-24",
                                                            "S50-24",
                                                            "S51-24",
                                                            "S52-24",
                                                            "S1-25",
                                                            "S2-25",
                                                            "S3-25",
                                                            "S4-25",
                                                            "S5-25",
                                                            "S6-25",
                                                            "S7-25",
                                                            "S8-25",
                                                            "S9-25",
                                                            "S10-25",
                                                            "S11-25",
                                                            "S12-25",
                                                            "S13-25",
                                                            "S14-25",
                                                            "S15-25",
                                                            "S16-25",
                                                            "S17-25",
                                                            "S18-25",
                                                            "S19-25",
                                                            "S20-25",
                                                            "S21-25",
                                                            "S22-25",
                                                            "S23-25",
                                                            "S24-25",
                                                            "S25-25",
                                                            "S26-25",
                                                            "S27-25",
                                                            "S28-25",
                                                            "S29-25",
                                                            "S30-25",
                                                            "S31-25",
                                                            "S32-25",
                                                            "S33-25",
                                                            "S34-25",
                                                            "S35-25",
                                                            "S36-25",
                                                            "S37-25",
                                                            "S38-25",
                                                            "S39-25",
                                                            "S40-25",
                                                            "S41-25",
                                                            "S42-25",
                                                            "S43-25",
                                                            "S44-25",
                                                            "S45-25",
                                                            "S46-25",
                                                            "S47-25",
                                                            "S48-25",
                                                            "S49-25",
                                                            "S50-25",
                                                            "S51-25",
                                                            "S52-25",
                                                            "S1-26",
                                                            "S2-26",
                                                            "S3-26",
                                                            "S4-26",
                                                            "S5-26",
                                                            "S6-26"
                                                  ],
                                                  "data": [
                                                            790,
                                                            818,
                                                            1008,
                                                            1133,
                                                            1041,
                                                            1157,
                                                            1191,
                                                            903,
                                                            784,
                                                            549,
                                                            479,
                                                            475,
                                                            468,
                                                            515,
                                                            562,
                                                            697,
                                                            843,
                                                            885,
                                                            495,
                                                            568,
                                                            603,
                                                            726,
                                                            750,
                                                            624,
                                                            356,
                                                            369,
                                                            363,
                                                            324,
                                                            314,
                                                            305,
                                                            312,
                                                            265,
                                                            235,
                                                            244,
                                                            289,
                                                            299,
                                                            297,
                                                            316,
                                                            164,
                                                            260,
                                                            198,
                                                            202,
                                                            219,
                                                            235,
                                                            207,
                                                            220,
                                                            239,
                                                            244,
                                                            228,
                                                            226,
                                                            219,
                                                            254,
                                                            155,
                                                            166,
                                                            167,
                                                            215,
                                                            203,
                                                            189,
                                                            210,
                                                            240,
                                                            223,
                                                            209
                                                  ],
                                                  "meta": 150,
                                                  "beforeIndex": 4,
                                                  "kpiSubtitle": "Gestión 25/26 vs Cierre 2024",
                                                  "borderColor": "#3b82f6",
                                                  "backgroundColor": "rgba(59, 130, 246, 0.1)",
                                                  "pointBackgroundColor": "#3b82f6",
                                                  "tension": 0.3,
                                                  "fill": true,
                                                  "borderWidth": 2
                                        }
                              ]
                    },
                    "achievements": [
                              {
                                        "title": "Reducción Histórica de Quejas",
                                        "desc": "Disminución notable en la tendencia mensual tras asumir la Jefatura en Nov 2024."
                              },
                              {
                                        "title": "Control de Folios MSO",
                                        "desc": "Reducción sostenida de folios históricos desde el pico de Diciembre 2024."
                              },
                              {
                                        "title": "Mejoras en CRM",
                                        "desc": "Se implementaron mejoras dentro de la plataforma CRM que impacta en la resolución de folios."
                              },
                              {
                                        "title": "Uso de IA",
                                        "desc": "Se implementaron mejoras con Uso de IA que impacta en solución de primer nivel y capacitaciones que permiten mejorar la calidad de la atención."
                              },
                              {
                                        "title": "Looker de Quejas",
                                        "desc": "Monitoreo de quejas con el objetivo de lograr reducción de las mismas."
                              }
                    ],
                    "roadmap": [
                              {
                                        "goal": "Mantener la resolución de MSO a la par del ingreso de nuevos folios.",
                                        "date": "PRIMER SEMESTRE 2026"
                              },
                              {
                                        "goal": "Auditoría de calidad para mantener quejas por debajo de la meta de 30.",
                                        "date": "JUNIO 2026"
                              },
                              {
                                        "goal": "Lograr el 100% de Certificación ECAP para el Q3",
                                        "date": "Q3 (JULIO-SEPTIEMBRE)"
                              },
                              {
                                        "goal": "Visitas bimestrales a tiendas con módulo de Asesor Previsional",
                                        "desc": "El objetivo es impactar en la atención de nuestros clientes, buscando encontrar áreas de oportunidad.",
                                        "date": ""
                              },
                              {
                                        "goal": "Generar Integración del QA a Salesforce.",
                                        "desc": "Mejorar en los indicadores clave NPS, TCR, Amabilidad, Solución de primer contacto, monitoreando y reduciendo tiempos de atención en casos escalados a los institutos.",
                                        "date": ""
                              },
                              {
                                        "goal": "Anexo de Biblioteca de Marcas a la Base de Conocimientos Servicios",
                                        "desc": "Con esta Biblioteca se unificaran las respuestas de cada una de las marcas, homologando la información y el objetivo es impactar en los siguientes indicadores: NPS, TCR, Amabilidad y reducción de escalamiento de folios.",
                                        "date": "Q1 (ENERO-MARZO)"
                              },
                              {
                                        "goal": "Medición del Nivel de Escalamiento de los N1's",
                                        "desc": "El objetivo es reducir el % de escalamiento, logrando identificar áreas de oportunidad.",
                                        "date": "Q1 (ENERO-MARZO)"
                              }
                    ]
          }
};
        // --- DATOS_FIN ---

        // =================================================================================
        // LÓGICA DEL ORGANIGRAMA
        // =================================================================================
        const orgData = {
            id: 'kevin',
            name: 'Kevin Zavala García',
            role: 'Gerente de Atención al Público',
            email: 'kevin.zavala@aforecoppel.com',
            imgText: 'KZ',
            level: 'manager',
            img: 'kevin_zavala.webp',
            children: [
                {
                    id: 'irain',
                    name: 'Irain Alonso Verdugo Avila',
                    role: 'Jefe de Servicios',
                    roleDetail: '(ATN CRM Módulo, MAO, Formulario Web)',
                    email: 'irain.verdugo@aforecoppel.com',
                    imgText: 'IV',
                    level: 'chief',
                    img: 'irain_verdugo.webp',
                    children: [
                        { id: 'gloria', name: 'Gloria Alejandra Sanchez Ibarra', role: 'Ejecutivo de Atención', roleDetail: 'CRM MAO Monitoreos MAO', email: 'gloria.sanchez@aforecoppel.com', imgText: 'GS', level: 'executive', img: 'gloria_sanchez.webp' },
                        { id: 'diana', name: 'Diana Isbeth Vega Villa', role: 'Ejecutivo de Atención', roleDetail: 'CRM MAO Monitoreos MAO', email: 'diana.vega@aforecoppel.com', imgText: 'DV', level: 'executive', img: 'diana_vega.webp' },
                        { id: 'maria', name: 'Maria De Los Angeles Leyva German', role: 'Ejecutivo de Atención', roleDetail: 'CRM MAO Monitoreos MAO', email: 'maria.leyva@aforecoppel.com', imgText: 'ML', level: 'executive', img: 'CSB_0193.jpg' },
                        { id: 'vianney', name: 'Vianney Iracema Castillo Montano', role: 'Ejecutivo de Atención', roleDetail: 'CRM MAO & CRM Formulario Web', email: 'vianney.castillo@aforecoppel.com', imgText: 'VC', level: 'executive', img: 'vianney_castillo.webp' },
                        { id: 'carmen', name: 'Carmen Francisca Moreno Acosta', role: 'Ejecutivo de Atención', roleDetail: 'CRM Módulo Atención a consultas CRA', email: 'carmen.moreno@aforecoppel.com', imgText: 'CM', level: 'executive', img: 'carmen_moreno.webp' },
                    ]
                },
                {
                    id: 'sergio',
                    name: 'Sergio Antonio Urieta Caro',
                    role: 'Soporte de Jefes de Servicio',
                    roleDetail: 'Seguimientos Especiales CRM',
                    email: 'sergio.urieta@aforecoppel.com',
                    imgText: 'SU',
                    level: 'support',
                    team: ['irain', 'misael'],
                    img: 'sergio_urieta.webp' 
                },
                {
                    id: 'misael',
                    name: 'Jesus Misael Gutierrez Nuñez',
                    role: 'Jefe de Servicios',
                    roleDetail: '(Servicios CAT & ATN CRM CAT)',
                    email: 'jesus.gutierrez@aforecoppel.com',
                    imgText: 'JG',
                    level: 'chief',
                    img: 'jesus_gutierrez.webp',
                    children: [
                            { id: 'jesus-noe', name: 'Jesús Noé Pinedo Beltran', role: 'Ejecutivo de Atención', roleDetail: 'CRM CAT Datos CAT', email: 'jesus.pinedo@aforecoppel.com', imgText: 'JP', level: 'executive', img: 'jesus_pinedo.webp' },
                            { id: 'jesus', name: 'Jesús Keanu Canedo Soto', role: 'Ejecutivo de Atención', roleDetail: 'CRM CAT Diálogos y Capacitación CAT', email: 'jesus.canedo@aforecoppel.com', imgText: 'JC', level: 'executive', img: 'jesus_canedo.webp' },
                            { id: 'dania', name: 'Dania Chávez', role: 'Ejecutivo de Atención', roleDetail: 'CRM CAT MPP y Capacitación CAT', email: 'dania.chavez@aforecoppel.com', imgText: 'DC', level: 'executive', img: 'dania_chavez.webp' },
                            { id: 'domenika', name: 'Domenika Guadalupe Felix Castro', role: 'Ejecutivo de Atención', roleDetail: 'CRM CAT & Seguimiento al cumplimiento MPP', email: 'domenika.felix@aforecoppel.com', imgText: 'DF', level: 'executive', img: 'domenika_felix.webp' },
                    ]
                }
            ]
        };

        function createCardHTML(person, viewType) {
            const isVertical = viewType === 'vertical';
            let dataAttrs = `data-name="${person.name.toLowerCase()}" ${person.email ? `data-email="${person.email}"` : ''}`;
            if (person.level === 'chief') dataAttrs += ` data-chief="${person.id}"`;
            if (person.level === 'executive') dataAttrs += ` data-team="${person.team}"`;
            if (person.level === 'support') dataAttrs += ` data-team="${person.team ? person.team.join(' ') : ''}"`;
            
            let styles = {
                manager: { wrapper: 'p-4 border-t-8', img: 'w-20 h-20 border-4', title: 'text-lg', color: 'border-[var(--color-blue)]' },
                chief: { wrapper: 'p-3 border-t-4', img: 'w-16 h-16 border-2', title: 'text-md', color: 'border-[var(--color-blue)]' },
                executive: { wrapper: 'p-3 border-t-2', img: 'w-16 h-16 border-2', title: 'text-sm', color: 'border-[var(--color-yellow)]' },
                support: { wrapper: 'p-3 border-t-4', img: 'w-16 h-16 border-2', title: 'text-md', color: 'border-teal-500', titleColor: 'text-teal-800' },
            };
            
            if (person.isVacant) {
                return `
                    <div class="card-wrapper" data-name="vacante">
                        <div class="card-content bg-white rounded-lg shadow-md p-3 border-t-4 border-[var(--color-blue)] cursor-pointer hover:shadow-xl hover:-translate-y-1">
                            <div class="w-16 h-16 rounded-full mx-auto mb-2 bg-gray-200 flex items-center justify-center border-2 border-[var(--color-blue)]"><svg class="w-10 h-10 text-gray-400" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg></div>
                            <h3 class="font-bold text-md text-[var(--color-blue)]">${person.name}</h3>
                            <p class="text-xs text-gray-500">${person.role}</p>
                            ${person.roleDetail ? `<p class="text-xs font-semibold text-gray-700 mt-1">${person.roleDetail}</p>` : ''}
                        </div>
                    </div>`;
            }

            const s = styles[person.level] || styles.executive;
            const imgColor = person.level === 'executive' ? 'FFD966/000000' : '002060/FFFFFF';
            const placeholderUrl = `https://placehold.co/${s.img.includes('20') ? '80x80' : '64x64'}/${person.level === 'support' ? '14B8A6/FFFFFF' : imgColor}?text=${person.imgText}`;
            const imgUrl = person.img ? person.img : placeholderUrl;

            return `
                <div class="card-wrapper" ${dataAttrs}>
                    <div class="card-content bg-white rounded-lg shadow-lg ${s.wrapper} ${s.color} cursor-pointer hover:shadow-2xl hover:-translate-y-1">
                        <img src="${imgUrl}" alt="Fotografía de perfil de ${person.name}" class="${s.img} rounded-full mx-auto mb-3 ${s.color} object-cover" onerror="this.src='${placeholderUrl}'; this.onerror=null;">
                        <h3 class="font-bold ${s.title} ${s.titleColor || 'text-[var(--color-blue)]'}">${person.name}</h3>
                        <p class="text-sm text-gray-600">${person.role}</p>
                        ${isVertical && person.roleDetail ? `<p class="text-xs font-semibold text-gray-700 mt-1">${person.roleDetail}</p>` : ''}
                    </div>
                </div>`;
        }

        function buildVerticalTree(person) {
            let childrenHTML = '';
            if (person.children && person.children.length > 0) {
                childrenHTML = `<ul>${person.children.map(child => buildVerticalTree(child)).join('')}</ul>`;
            }
            const liClass = person.level === 'support' ? 'class="support-role"' : '';
            const liId = `id="li-${person.id}"`;
            return `<li ${liId} ${liClass}>${createCardHTML(person, 'vertical')}${childrenHTML}</li>`;
        }

        function buildHorizontalView(data) {
            const managerHTML = `<div class="gerente-col">${createCardHTML(data, 'horizontal')}</div>`;
            
            const teamsHTML = data.children.map(person => {
                const liClass = person.level === 'support' ? 'support-role' : '';
                let teamMembersHTML = '';

                if (person.children && person.children.length > 0) {
                    person.children.forEach(member => member.team = person.id);
                    const members = person.children.map(member => createCardHTML(member, 'horizontal')).join('');
                    teamMembersHTML = `<div class="ejecutivos-row">${members}</div>`;
                }
                
                return `<div id="h-li-${person.id}" class="jefe-item ${liClass}">${createCardHTML(person, 'horizontal')}${teamMembersHTML}</div>`;
            }).join('');

            return `${managerHTML}<div class="jefes-col">${teamsHTML}</div>`;
        }

        function findSupportRoles(data) {
            return data.children ? data.children.filter(p => p.level === 'support') : [];
        }

        function drawVerticalSupportLine(sourceNode, targetNode, svg) {
                if (!sourceNode || !targetNode || !svg) return;

            const sourceCard = sourceNode.querySelector('.card-wrapper');
            const targetCard = targetNode.querySelector('.card-wrapper');
            if (!sourceCard || !targetCard) return;

            const sourceRect = sourceCard.getBoundingClientRect();
            const targetRect = targetCard.getBoundingClientRect();
            const containerRect = svg.parentElement.getBoundingClientRect();

            // Si los rects son 0 (ocultos), abortar
            if (sourceRect.width === 0 || targetRect.width === 0) return;

            const isTargetLeft = targetRect.left < sourceRect.left;
            
            const startY = sourceRect.top + sourceRect.height / 2 - containerRect.top;
            const endY = targetRect.top + targetRect.height / 2 - containerRect.top;

            const startX = isTargetLeft 
                ? sourceRect.left - containerRect.left 
                : sourceRect.right - containerRect.left;
            
            const endX = isTargetLeft 
                ? targetRect.right - containerRect.left 
                : targetRect.left - containerRect.left;

            const pathData = `M ${startX} ${startY} L ${endX} ${endY}`;
            
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('d', pathData);
            path.setAttribute('stroke', 'var(--color-blue)');
            path.setAttribute('stroke-width', '2');
            path.setAttribute('fill', 'transparent');
            path.setAttribute('stroke-dasharray', '5, 5');
            svg.appendChild(path);
        }

        function setupVerticalSupportConnections() {
            const container = document.querySelector('#vertical-view > ul');
            if (!container) return;

            // FIX: Select specific class to avoid selecting icons inside cards
            const existingSvg = container.querySelector('svg.org-lines');
            if (existingSvg) {
                if (existingSvg.parentNode === container) {
                    container.removeChild(existingSvg);
                } else {
                    existingSvg.remove();
                }
            }

            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.classList.add('org-lines'); // Clase identificadora
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.style.pointerEvents = 'none';
            svg.style.zIndex = '0';
            container.style.position = 'relative';
            container.appendChild(svg);
            
            const supportRoles = findSupportRoles(orgData);
            supportRoles.forEach(person => {
                const sourceNode = document.getElementById(`li-${person.id}`);
                if (sourceNode && person.team) {
                    person.team.forEach(targetId => {
                        const targetNode = document.getElementById(`li-${targetId}`);
                        drawVerticalSupportLine(sourceNode, targetNode, svg);
                    });
                }
            });
        }

        function drawHorizontalSupportLine(sourceNode, targetNode, svg) {
                if (!sourceNode || !targetNode || !svg) return;
            const sourceCard = sourceNode.querySelector('.card-wrapper');
            const targetCard = targetNode.querySelector('.card-wrapper');
            if (!sourceCard || !targetCard) return;

            const sourceRect = sourceCard.getBoundingClientRect();
            const targetRect = targetCard.getBoundingClientRect();
            const containerRect = svg.parentElement.getBoundingClientRect();

            const startX = sourceRect.right - containerRect.left;
            const startY = sourceRect.top + sourceRect.height / 2 - containerRect.top;
            
            const endX = targetRect.left - containerRect.left;
            const endY = targetRect.top + targetRect.height / 2 - containerRect.top;
            
            const pathData = `M ${startX} ${startY} L ${endX} ${endY}`;
            
            const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
            path.setAttribute('d', pathData);
            path.setAttribute('stroke', 'var(--color-blue)');
            path.setAttribute('stroke-width', '2');
            path.setAttribute('fill', 'transparent');
            path.setAttribute('stroke-dasharray', '5, 5');
            svg.appendChild(path);
        }
        
        function setupHorizontalConnections() {
            const container = document.getElementById('horizontal-view');
            if (!container) return;

            // FIX: Select specific class to avoid selecting icons inside cards
            const existingSvg = container.querySelector('svg.org-lines');
            if (existingSvg) {
                if (existingSvg.parentNode === container) {
                    container.removeChild(existingSvg);
                } else {
                    existingSvg.remove();
                }
            }

            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.classList.add('org-lines'); // Clase identificadora
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.style.pointerEvents = 'none';
            svg.style.zIndex = '0';
            container.style.position = 'relative';
            container.appendChild(svg);
            
            const supportRoles = findSupportRoles(orgData);
            supportRoles.forEach(person => {
                const sourceNode = document.getElementById(`h-li-${person.id}`);
                if (sourceNode && person.team) {
                    person.team.forEach(targetId => {
                        const targetNode = document.getElementById(`h-li-${targetId}`);
                        drawHorizontalSupportLine(sourceNode, targetNode, svg);
                    });
                }
            });
        }

        let organogramInitialized = false;

        function initOrganogram() {
            const verticalContainer = document.querySelector('#vertical-view ul');
            if(verticalContainer) verticalContainer.innerHTML = buildVerticalTree(orgData);

            const horizontalContainer = document.getElementById('horizontal-view');
            if(horizontalContainer) horizontalContainer.innerHTML = buildHorizontalView(orgData);

            // Búsqueda
            const searchBox = document.getElementById('search-box');
            if(searchBox) {
                searchBox.addEventListener('input', (e) => {
                    const searchTerm = e.target.value.toLowerCase();
                    const allCards = document.querySelectorAll('.card-wrapper');
                    allCards.forEach(cardWrapper => {
                        cardWrapper.classList.remove('highlight-search', 'dimmed');
                        const cardName = cardWrapper.dataset.name ? cardWrapper.dataset.name.toLowerCase() : '';
                        if (searchTerm.length > 0) {
                            if (cardName.includes(searchTerm)) {
                                cardWrapper.classList.add('highlight-search');
                            } else {
                                cardWrapper.classList.add('dimmed');
                            }
                        }
                    });
                });
            }

            // Toggle Vista
            const viewToggle = document.getElementById('view-toggle');
            const verticalView = document.getElementById('vertical-view');
            const horizCont = document.getElementById('horizontal-view');
            
            if(viewToggle) {
                viewToggle.addEventListener('click', () => {
                    const isVertical = !verticalView.classList.contains('hidden');
                    if (isVertical) {
                        verticalView.classList.add('hidden');
                        horizCont.classList.remove('hidden');
                        viewToggle.textContent = 'Cambiar a Vista Vertical';
                        document.getElementById('org-chart-container').classList.add('horizontal-view');
                        document.getElementById('org-chart-container').classList.remove('vertical-view');
                        // Dibujar líneas horizontales
                        requestAnimationFrame(() => setupHorizontalConnections());
                    } else {
                        horizCont.classList.add('hidden');
                        verticalView.classList.remove('hidden');
                        viewToggle.textContent = 'Cambiar a Vista Horizontal';
                        document.getElementById('org-chart-container').classList.add('vertical-view');
                        document.getElementById('org-chart-container').classList.remove('horizontal-view');
                    }
                });
            }

            // Highlight Equipos
            const chiefCards = document.querySelectorAll('[data-chief]');
            chiefCards.forEach(chiefCard => {
                chiefCard.addEventListener('mouseenter', () => {
                    if (searchBox && searchBox.value.length > 0) return; 
                    const teamId = chiefCard.dataset.chief;
                    const allCards = document.querySelectorAll('.card-wrapper');
                    allCards.forEach(card => {
                        const cardTeams = card.dataset.team || '';
                        if (card.dataset.chief !== teamId && !cardTeams.includes(teamId)) {
                            card.classList.add('dimmed');
                        }
                    });
                });
                chiefCard.addEventListener('mouseleave', () => {
                    if (searchBox && searchBox.value.length > 0) return;
                    document.querySelectorAll('.card-wrapper').forEach(card => card.classList.remove('dimmed'));
                });
            });

            // Modales
            const zoomModal = document.getElementById('zoomModal');
            const modalContent = document.getElementById('modalContent');
            const closeModal = document.getElementById('closeModal');
            const imageZoomModal = document.getElementById('imageZoomModal');
            const zoomedImage = document.getElementById('zoomedImage');
            const closeImageModal = document.getElementById('closeImageModal');

            document.querySelectorAll('.card-wrapper').forEach(cardWrapper => {
                const cardContent = cardWrapper.querySelector('.card-content');
                if (!cardContent) return;
                
                const img = cardWrapper.querySelector('img');

                cardContent.addEventListener('click', () => {
                    while (modalContent.lastChild && modalContent.lastChild.id !== 'closeModal') {
                        modalContent.removeChild(modalContent.lastChild);
                    }
                    
                    const newContent = cardContent.cloneNode(true);
                    newContent.classList.add('card-clone');
                    newContent.classList.remove('cursor-pointer', 'hover:shadow-2xl', 'hover:-translate-y-1', 'hover:shadow-xl', 'hover:shadow-lg', 'h-full');
                    
                    const imgClone = newContent.querySelector('img');
                    if (imgClone) {
                        imgClone.classList.remove('w-16','w-20','h-16','h-20');
                        imgClone.classList.add('w-24', 'h-24');
                    }
                    
                    modalContent.appendChild(newContent);
                    
                    const email = cardWrapper.dataset.email;
                    if(email){
                        const contactInfo = document.createElement('div');
                        contactInfo.classList.add('mt-4','pt-4','border-t','text-left','text-sm', 'space-y-3');
                        contactInfo.innerHTML = `
                            <p class="flex items-center text-gray-700">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25-2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75" /></svg>
                                <a href="mailto:${email}" class="hover:underline">${email}</a>
                            </p>
                            <a href="https://teams.microsoft.com/l/chat/0/0?users=${email}" target="_blank" rel="noopener noreferrer" class="w-full flex items-center justify-center px-3 py-2 bg-purple-600 text-white font-semibold rounded-lg hover:bg-purple-700 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24"><path d="M21.92,6.58A1,1,0,0,0,21,6H16.5A1.5,1.5,0,0,0,15,7.5V12H13V7.5A1.5,1.5,0,0,0,11.5,6H7A1,1,0,0,0,6,7V17a1,1,0,0,0,1,1h.5a1.5,1.5,0,0,0,1.5-1.5V12h2v4.5A1.5,1.5,0,0,0,13.5,18H18a1,1,0,0,0,1-1V9.42l2.92,2.92A1,1,0,0,0,22.62,11.62Z"></path><path d="M4,6A2,2,0,1,0,6,8,2,2,0,0,0,4,6Z"></path><path d="M11,10.5A2.5,2.5,0,1,0,13.5,13,2.5,2.5,0,0,0,11,10.5Z"></path><path d="M19,10a2,2,0,1,0,2,2,2,2,0,0,0-2-2Z"></path></svg>
                                Iniciar Chat en Teams
                            </a>
                            `;
                        modalContent.appendChild(contactInfo);
                    }

                    zoomModal.classList.remove('hidden');
                    zoomModal.classList.add('flex');
                });

                if (img) {
                    img.addEventListener('click', (e) => {
                        e.stopPropagation();
                        if (e.target.src.includes('placehold.co')) return;
                        zoomedImage.src = e.target.src;
                        imageZoomModal.classList.remove('hidden');
                        imageZoomModal.classList.add('flex');
                    });
                }
            });

            const hideCardModal = () => { zoomModal.classList.add('hidden'); zoomModal.classList.remove('flex'); }
            const hideImageModal = () => { imageZoomModal.classList.add('hidden'); imageZoomModal.classList.remove('flex'); }

            closeModal.addEventListener('click', hideCardModal);
            closeImageModal.addEventListener('click', hideImageModal);
            zoomModal.addEventListener('click', e => { if (e.target === zoomModal) hideCardModal(); });
            imageZoomModal.addEventListener('click', e => { if (e.target === imageZoomModal) hideImageModal(); });
        }

        // =================================================================================
        // LÓGICA DEL DASHBOARD EXISTENTE
        // =================================================================================
        let chartInstance = null;
        let volumeChartInstance = null;
        let currentProfileData = null;

        function showAbout() {
            // 1. Mostrar Seccion About
            document.getElementById('dashboard-section').classList.add('hidden');
            document.getElementById('about-section').classList.remove('hidden');

            // 2. Estilos Botones
            document.getElementById('btn-about').className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition bg-white text-blue-900 shadow-lg';
            const dimStyle = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white';
            document.getElementById('btn-user1').className = dimStyle;
            document.getElementById('btn-user2').className = dimStyle;

            // 3. Inicializar Organigrama si no se ha hecho
            if (!organogramInitialized) {
                initOrganogram();
                organogramInitialized = true;
                // Forzar dibujo de líneas después de que el elemento sea visible
                setTimeout(() => {
                    requestAnimationFrame(() => setupVerticalSupportConnections());
                }, 100);
            } else {
                // Redibujar líneas por si cambiaron dimensiones al ocultar/mostrar
                requestAnimationFrame(() => {
                    setupVerticalSupportConnections();
                    // setupHorizontalConnections solo si está activo
                    if(document.getElementById('org-chart-container').classList.contains('horizontal-view')) {
                        setupHorizontalConnections();
                    }
                });
            }
        }

        function switchProfile(userId) {
            document.getElementById('about-section').classList.add('hidden');
            document.getElementById('dashboard-section').classList.remove('hidden');
            document.getElementById('btn-about').className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white';

            const profile = profiles[userId];
            currentProfileData = profile; 
            
            const btn1 = document.getElementById('btn-user1');
            const btn2 = document.getElementById('btn-user2');
            
            if (userId === 'user1') {
                btn1.className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition bg-white text-blue-900 shadow-lg';
                btn2.className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white';
            } else {
                btn2.className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition bg-white text-blue-900 shadow-lg';
                btn1.className = 'px-4 py-2 md:px-6 md:py-2 rounded-full text-xs md:text-sm font-semibold transition hover:bg-white/20 text-white';
            }

            document.getElementById('chart-title').innerText = profile.customTitle || `Indicadores de ${profile.name}`;
            const sub = document.getElementById('chart-subtitle');
            if(sub) {
                sub.innerText = profile.customSubtitle || "Lectura de datos: Drive A1:M8 (Escala 0-100%) • Meta: Columna N";
            }
            
            populateVolumeFilters();
            updateVolumeChartDisplay();
            populateFilters(profile);
            generateKPICards(profile, 'all');
            updateChartDisplay();
            updateTextContent(profile);
        }

        function calculateAverage(arr) {
            const nonZeroValues = arr.filter(v => v > 0);
            if (nonZeroValues.length === 0) return 0;
            const sum = nonZeroValues.reduce((a, b) => a + b, 0);
            return sum / nonZeroValues.length;
        }

        function generateKPICards(profile, filterIndex) {
            const container = document.getElementById('kpi-container');
            container.innerHTML = '';
            const currentFilter = String(filterIndex);
            const isFiltered = currentFilter !== 'all';

            profile.chartData.datasets.forEach((dataset, index) => {
                if (isFiltered && String(index) !== currentFilter) return;
                if (dataset.label === 'Meta' && profile.chartType === 'bar') return;

                const dataPoints = dataset.data;
                const lastValue = dataPoints[dataPoints.length - 1] || 0;
                const metaValue = dataset.meta ? dataset.meta + '%' : 'N/A';
                
                // Nuevas variables
                let difference = 0, subtitleText = "", isPositive = false, displayDiff = "", displayValue = lastValue;

                // Lógica especial para Gráficas de Línea con 12 meses (User 1) o más
                // Si es User 2 (Irain), sus datos tienen más de 12 meses, por lo que usamos lógica de mes previo por defecto
                // A menos que queramos lógica específica para él.
                // Usaré la lógica 'standard' (mes previo) si dataPoints != 12, para simplificar por ahora con los nuevos datos de Irain.
                
                if (profile.chartType === 'line' && dataPoints.length === 12 && !isFiltered) {
                    // MODO 1: Vista Semestral (User 1)
                    const sem1Data = dataPoints.slice(0, 6);
                    const sem2Data = dataPoints.slice(6, 12);
                    const avgSem1 = calculateAverage(sem1Data);
                    const avgSem2 = calculateAverage(sem2Data);
                    difference = (avgSem2 - avgSem1).toFixed(2);
                    subtitleText = "vs. Prom. 1er Sem";
                    isPositive = (avgSem2 >= avgSem1);
                    displayValue = avgSem2.toFixed(2);
                } else {
                    // MODO 2: Mes a Mes (User 2 y filtros)
                    // Tomamos los dos últimos valores disponibles
                    const prevValue = dataPoints[dataPoints.length - 2] || 0;
                    difference = (lastValue - prevValue).toFixed(2);
                    subtitleText = dataset.kpiSubtitle || "vs. mes anterior";
                    isPositive = difference >= 0;
                    displayValue = typeof lastValue === 'number' ? lastValue.toFixed(2) : lastValue;
                }

                // Ajuste Inverse Trend (Si menos es mejor, invierte isPositive)
                if (profile.inverseTrend) {
                    isPositive = !isPositive; // Si subió (true), ahora es malo (false). Si bajó (false), ahora es bueno (true).
                    // Corrección: diff >= 0 (subió) -> isPositive = true. Inverse -> false.
                    // diff < 0 (bajó) -> isPositive = false. Inverse -> true.
                    // Espera, mi lógica anterior era: isPositive = diff >= 0.
                    // Si diff es positivo (subió), es malo -> false.
                    // Si diff es negativo (bajó), es bueno -> true.
                    isPositive = difference <= 0;
                }

                if (isFiltered) {
                    const sign = difference > 0 ? '+' : ''; 
                    displayDiff = `${sign}${difference}%`;
                } else {
                    // Flecha arriba si subió, abajo si bajó (independiente de si es bueno o malo)
                    const arrow = difference >= 0 ? '↑' : '↓'; 
                    displayDiff = `${arrow} ${Math.abs(difference)}%`;
                }

                // Colores
                const borderColor = isPositive ? '#16a34a' : '#dc2626'; // Verde si bueno, Rojo si malo
                const trendColor = isPositive ? 'text-green-600' : 'text-red-600';
                const trendBg = isPositive ? 'bg-green-100' : 'bg-red-100';

                const cardHTML = `
                    <div class="bg-white p-5 rounded-xl border-t-4 shadow-sm hover:shadow-md transition-shadow relative" style="border-color: ${borderColor}">
                        <div class="flex justify-between items-start mb-2">
                            <p class="text-xs font-bold text-gray-500 uppercase tracking-wider">${dataset.label}</p>
                            <span class="${trendBg} ${trendColor} text-[10px] px-2 py-0.5 rounded-full font-bold flex items-center gap-1">${displayDiff}</span>
                        </div>
                        <h3 class="text-3xl font-black text-gray-800">${displayValue}</h3>
                        <div class="flex justify-between items-end mt-2">
                            <p class="text-[10px] text-gray-400">${subtitleText}</p>
                            <div class="text-right">
                                <span class="block text-[10px] font-bold text-gray-400 uppercase">Meta</span>
                                <span class="text-sm font-bold text-blue-900">${metaValue}</span>
                            </div>
                        </div>
                    </div>`;
                container.innerHTML += cardHTML;
            });
        }

        function populateFilters(profile) { /* ... Same logic ... */ 
            const indicatorSelect = document.getElementById('filter-indicator');
            indicatorSelect.innerHTML = '<option value="all">Todos los Indicadores</option>';
            profile.chartData.datasets.forEach((dataset, index) => {
                if (dataset.label === 'Meta' && profile.chartType === 'bar') return;
                const option = document.createElement('option');
                option.value = index; option.text = dataset.label; indicatorSelect.appendChild(option);
            });
            const xaxisSelect = document.getElementById('filter-xaxis');
            xaxisSelect.innerHTML = '<option value="all">Vista General</option>';
            profile.chartData.labels.forEach((label, index) => {
                const option = document.createElement('option');
                option.value = index; option.text = label; xaxisSelect.appendChild(option);
            });
        }

        function updateChartDisplay() {
            if (!currentProfileData) return;
            const selectedIndicatorIndex = document.getElementById('filter-indicator').value;
            const selectedXAxisIndex = document.getElementById('filter-xaxis').value;
            const isSingleIndicator = selectedIndicatorIndex !== 'all';

            generateKPICards(currentProfileData, selectedIndicatorIndex);

            let filteredLabels = [...currentProfileData.chartData.labels];
            let filteredDatasets = currentProfileData.chartData.datasets.map(d => ({ ...d, data: [...d.data] }));

            if (selectedXAxisIndex !== 'all') {
                const idx = parseInt(selectedXAxisIndex);
                filteredLabels = [filteredLabels[idx]];
                filteredDatasets.forEach(d => { d.data = [d.data[idx]]; });
            }
            if (isSingleIndicator) {
                const idx = parseInt(selectedIndicatorIndex);
                filteredDatasets = [filteredDatasets[idx]];
            }

            if (chartInstance) chartInstance.destroy();
            const ctx = document.getElementById('mainChart').getContext('2d');
            
            const datalabelsConfig = isSingleIndicator ? {
                display: true, align: 'top', anchor: 'end', offset: 4,
                color: function(context) {
                    if (context.dataIndex === 0) return '#64748b';
                    const current = context.dataset.data[context.dataIndex];
                    const prev = context.dataset.data[context.dataIndex - 1];
                    // Logic for user 2 inverse trend label color
                    if (currentProfileData.inverseTrend) {
                         return (current <= prev) ? '#16a34a' : '#dc2626'; // Less is Green
                    }
                    return (current >= prev) ? '#16a34a' : '#dc2626'; 
                },
                font: { weight: 'bold', size: 11 },
                formatter: function(value, context) {
                    if (context.dataIndex === 0) return value;
                    const prev = context.dataset.data[context.dataIndex - 1];
                    const diff = (value - prev).toFixed(0);
                    const arrow = diff >= 0 ? '▲' : '▼';
                    return [value, arrow + ' ' + Math.abs(diff)];
                }
            } : { display: false };

            chartInstance = new Chart(ctx, {
                type: currentProfileData.chartType,
                data: { labels: filteredLabels, datasets: filteredDatasets },
                options: {
                    responsive: true, maintainAspectRatio: false, layout: { padding: { top: 30 } },
                    scales: { y: { beginAtZero: true, grid: { color: '#f1f5f9' } }, x: { ticks: { font: { size: 10 } }, grid: { display: false } } },
                    plugins: {
                        datalabels: datalabelsConfig,
                        legend: { position: 'bottom', labels: { boxWidth: 12, padding: 20, font: { size: 11 }, usePointStyle: true } },
                        tooltip: { enabled: !isSingleIndicator }
                    }
                }
            });
        }

        function updateTextContent(profile) {
            document.getElementById('achievements-list').innerHTML = profile.achievements.map(item => `
                <li>
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">${item.title}</h3>
                    <p class="text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">${item.desc}</p>
                </li>`).join('');
            document.getElementById('roadmap-container').innerHTML = profile.roadmap.map(item => `
                <div class="timeline-item pl-8 relative">
                    <h3 class="text-base md:text-lg font-bold text-gray-800 editable-focus" contenteditable="true">${item.goal}</h3>
                    ${item.desc ? `<p class="text-sm text-gray-600 mt-2 mb-1 editable-focus" contenteditable="true">${item.desc}</p>` : ''}
                    <span class="block mt-1 text-sm md:text-base text-gray-600 editable-focus" contenteditable="true">${item.date}</span>
                </div>`).join('');
        }

        function populateVolumeFilters() {
            const monthSelect = document.getElementById('filter-volume-month');
            if (monthSelect && monthSelect.options.length <= 1) {
                months.forEach((m, index) => {
                    const opt = document.createElement('option'); opt.value = index; opt.text = m; monthSelect.appendChild(opt);
                });
            }
        }
        function updateVolumeChartDisplay() {
            const section = document.getElementById('volume-section');
            
            // Ocultar sección completa si no hay datos de volumen configurados (Caso Irain)
            if (!currentProfileData || !currentProfileData.volumeData || !currentProfileData.volumeData.inbound || currentProfileData.volumeData.inbound.length === 0) {
                if (section) section.classList.add('hidden');
                return; 
            } else {
                if (section) section.classList.remove('hidden');
            }

            const dataIn = currentProfileData.volumeData.inbound || [];
            const dataOut = currentProfileData.volumeData.outbound || [];
            const totalIn = dataIn.reduce((a, b) => a + b, 0);
            const totalOut = dataOut.reduce((a, b) => a + b, 0);
            const elIn = document.getElementById('total-inbound'); if(elIn) elIn.innerText = totalIn.toLocaleString();
            const elOut = document.getElementById('total-outbound'); if(elOut) elOut.innerText = totalOut.toLocaleString();

            const selectedChannel = document.getElementById('filter-volume-channel').value;
            const selectedMonth = document.getElementById('filter-volume-month').value;
            let filteredLabels = [...months], filteredDataIn = [...dataIn], filteredDataOut = [...dataOut];

            if (selectedMonth !== 'all') {
                const idx = parseInt(selectedMonth);
                filteredLabels = [months[idx]]; filteredDataIn = [dataIn[idx]]; filteredDataOut = [dataOut[idx]];
            }
            let datasets = [];
            if (selectedChannel === 'all' || selectedChannel === 'inbound') datasets.push({ label: 'Inbound', borderColor: '#6366f1', backgroundColor: 'transparent', pointBackgroundColor: '#6366f1', tension: 0.3, borderWidth: 3, data: filteredDataIn });
            if (selectedChannel === 'all' || selectedChannel === 'outbound') datasets.push({ label: 'Outbound', borderColor: '#f97316', backgroundColor: 'transparent', pointBackgroundColor: '#f97316', tension: 0.3, borderWidth: 3, data: filteredDataOut });

            if (volumeChartInstance) volumeChartInstance.destroy();
            const ctx = document.getElementById('volumeChart').getContext('2d');
            const isSingleChannel = (selectedChannel !== 'all');

            volumeChartInstance = new Chart(ctx, {
                type: 'line', data: { labels: filteredLabels, datasets: datasets },
                options: {
                    responsive: true, maintainAspectRatio: false, layout: { padding: { top: 30 } },
                    scales: { y: { beginAtZero: true, grid: { color: '#f1f5f9' } }, x: { grid: { display: false } } },
                    plugins: {
                        legend: { position: 'top' },
                        datalabels: {
                            display: isSingleChannel, color: '#64748b', align: 'top', anchor: 'end', font: { size: 10, weight: 'bold' },
                            formatter: (value, context) => {
                                if (!isSingleChannel) return '';
                                const valStr = (value/1000).toFixed(1) + 'k';
                                if (context.dataIndex === 0) return valStr;
                                const prev = context.dataset.data[context.dataIndex - 1];
                                const diff = value - prev; const diffPercent = ((diff / prev) * 100).toFixed(1); const arrow = diff >= 0 ? '▲' : '▼';
                                return [valStr, arrow + ' ' + Math.abs(diffPercent) + '%'];
                            }
                        }
                    }
                }
            });
        }

        function saveAndDownloadHTML() {
            const isUser1 = document.getElementById('btn-user1').classList.contains('bg-white');
            const userId = isUser1 ? 'user1' : 'user2';
            const achievementsList = document.querySelectorAll('#achievements-list li');
            profiles[userId].achievements = Array.from(achievementsList).map(li => ({ title: li.querySelector('h3').innerHTML, desc: li.querySelector('p').innerHTML }));
            const roadmapList = document.querySelectorAll('#roadmap-container .timeline-item');
            profiles[userId].roadmap = Array.from(roadmapList).map(item => ({ goal: item.querySelector('h3').innerHTML, desc: item.querySelector('p') ? item.querySelector('p').innerHTML : undefined, date: item.querySelector('span').innerHTML }));
            let currentHTML = document.documentElement.outerHTML;
            const regex = /\/\/ --- DATOS_INICIO ---[\s\S]*?\/\/ --- DATOS_FIN ---/;
            const replacement = `// --- DATOS_INICIO ---\n        let profiles = ${JSON.stringify(profiles, null, 12)};\n        // --- DATOS_FIN ---`;
            let newHTML = currentHTML.replace(regex, replacement);
            newHTML = '<!DOCTYPE html>\n' + newHTML;
            const blob = new Blob([newHTML], { type: 'text/html' }); const url = URL.createObjectURL(blob);
            const a = document.createElement('a'); a.href = url; a.download = 'dashboard_actualizado.html';
            document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
            alert("Tus textos se han guardado. Se ha descargado tu archivo 'dashboard_actualizado.html' con los últimos cambios.");
        }

        document.addEventListener('DOMContentLoaded', () => {
            switchProfile('user1');
        });
    </script>

</body></html>
